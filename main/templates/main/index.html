{% extends "edd_base.html" %}
{% load staticfiles %}

{% block js_css %}
    {{ block.super }}
    <!-- jQuery-UI needed for EDDAutocomplete -->
    <script type="text/javascript" src="{% static 'main/js/lib/bootstrap/bootstrap.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'main/js/lib/bootstrap/bootstrap.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'main/js/lib/jquery-ui/jquery-ui.min.css' %}"/>
    <script type="text/javascript" src="{% static 'main/js/lib/jquery-ui/jquery-ui.min.js' %}"></script>
    <!-- -->
    <script type="text/javascript" src="{% static 'main/js/Utl.js' %}"></script>
    <script type="text/javascript" src="{% static 'main/js/Dragboxes.js' %}"></script>
    <script type="text/javascript" src="{% static 'main/js/EDDAutocomplete.js' %}"></script>
    <script type="text/javascript" src="{% static 'main/js/DataGrid.js' %}"></script>
    <script type="text/javascript" src="{% static 'main/js/index.js' %}"></script>
{% endblock js_css %}


{% block status %}
    {% if form.errors %}
    <div class="alert alert-danger alert-dismissible" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        {{ form.errors }}
    </div>
    {% endif %}
    {{ block.super }}
{% endblock status %}


{% block content %}
    {% if can_create %}

        <div style="float: right">
            <button id="addStudyButton"
                    class="actionButton primary larger"
                    title="Add a new study">
                Add New Study
            </button>
        </div>
    {% endif %}
    <h2 {%  if latest_viewed_studies %} style="margin-bottom:12px;" {% else %} style="margin-bottom: 50px;" {% endif %}>
        Recently viewed Studies:</h2>
    <div class="lastViewed">
        {% for study in latest_viewed_studies %}
            <span><a href="{% url 'main:detail' slug=study.slug %}">{{ study.name }}</a></span>
            {% if not forloop.last %}{% endif %}
        {% endfor %}
    </div>

    <h2>All Studies:</h2>
    <table id="studiesTable"></table>

{% endblock content %}

{% block body_postfix %}

<div id="addStudyModal" class="off"
     title="Add New Study">
    <form action="" class="edd-form" method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" name="action" value="assay">Add Study</button>
    </form>
</div>

    {{ block.super }}
{% endblock body_postfix %}