{% extends "main/study.html" %}
{% load staticfiles %}

{% block js_css %}
  {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'main/import2.css' %}" />
    <link rel="stylesheet" href="https://unpkg.com/vue-form-wizard/dist/vue-form-wizard.min.css">
    <script type="text/javascript" src="{% static 'dist/Import2.js' %}"></script>
{% endblock js_css %}

{% block head_title %}
  {% if selection.studies|length == 1 %}
    Data Import For {{ selection.studies.0.name }}
  {% else %}
    Data Import For {{ selection.studies|length }} Studies
  {% endif %}
{% endblock head_title %}

{% block body_title %}
  Data Import For
   <a href="{% url 'main:detail' slug=study.slug %}">{{ study.name }}</a>
{% endblock body_title %}
<!-- Step 1 -->

{% block content %}
    <form method="post" id="assayTableForm" action="{% url 'main:table-import' slug=study.slug %}">
        {% csrf_token %}
        <div id="app">
        <div>
            <form-wizard @on-complete="onComplete"
                         @on-loading="setLoading"
                         @on-validate="handleValidation"
                         shape="tab"
                         color="#23527c"
                         title=""
                         subtitle="">
              <tab-content title="Types of Data"
                           :before-change="validateAsync"
                           icon="ti-user">
                <div class="border-box">
                    <div class="headers" >What Category of Data do you have?</div>
                    <button class="btn btn-default btn-step1"  v-for="category in importOptions.categories"
                       v-on:click.prevent="selectCategory">
                        ${ category.name }
                    </button>
                    <p>Don't see your category?<a href="mailto:jbei-help@lbl.gov?subject=EDD">
                     Contact support</a></p>
                </div>
                <div class="border-box off" id="protocols">
                    <div class="headers">What Protocol did you use?</div>

                    <button class="btn btn-default btn-step1" v-for="protocol in protocols"
                            v-on:click.prevent="selectProtocol">
                        ${ protocol.name }
                    </button>
                   <p>Don't see your protocol?<a href="mailto:jbei-help@lbl
                   .gov?subject=EDD">Contact support</a></p>
                </div>
                    <div id="fileFormat" class="border-box off">
                      <span class="headers">File format</span>
                      <span v-for="format in formats">
                          <p>
                            <input type="checkbox" v-if="formats.length === 1" checked
                                   v-on:change.prevent="selectFormats">
                            <input type="checkbox" v-else v-on:change.prevent="selectFormats">
                          ${ format.name }
                          <span class="exampleFile" v-if="format.name == 'Biolector XML File'">
                                <a href="{% static 'Biolector.xml' %}">Example File</a>
                            </span>
                            <span class="exampleFile" v-if="format.name== 'Skyline'">
                                 <a href="{% static 'skyline_example.csv' %}">Example File</a>
                            </span>
                            <span class="exampleFile"  v-if="format.name == 'Generic Import File'
                            || format.name == 'Cufflinks file'">
                                <a href="{% static 'GC-MS_example.xlsx' %}">Example File</a>
                            </span>
                          </p>
                      </span>
                    </div>
              </tab-content>
              <tab-content title="Upload File"
                           icon="ti-settings">
                      <div> <span class="uploadHeader">${ selectedProtocol }</span>
                            <span>Examples</span>
                            <span>Download Example</span>
                      </div>
                      <div id="importDropZone2">
                          <textarea style="width:100%" class="fd-zone" rows="16" id="step2textarea2"
                            name="step2textarea2"></textarea>
                      </div>
                     <my-dropzone @clicked-show-detail="clickedShowDetailModal" :current-mode="mode">
                     </my-dropzone>
              </tab-content>
              <tab-content title="Resolve"
                           icon="ti-check">
                      <p>Help EDD resolve inputs from your file</p>
                      <div>
                        <table class="table table-striped">
                            <thead>
                                <th v-for="item in headers">
                                    ${ item }
                                </th>
                            </thead>
                            <tbody>
                                <tr v-for="row in importedData">
                                    <th v-for="string in row"> ${string} </th>
                                </tr>
                            </tbody>
                        </table>
                      </div>
              </tab-content>
                <tab-content title="Inspect"
                           icon="ti-check">
                      <h3>Graph of data</h3>
              </tab-content>
                <tab-content title="Import"
                           icon="ti-check">
                      <h3>Ready to import</h3>
              </tab-content>

              <div class="loader" v-if="loadingWizard"></div>
            </form-wizard>
         </div>
        </div>
</form>
{% endblock content %}