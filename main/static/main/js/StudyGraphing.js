// File last modified on: Thu Oct 27 2016 11:41:46  
/// <reference path="../typings/d3/d3.d.ts"/>;
/// <reference path="GraphHelperMethods.ts" />
/// <reference path="StudyGraphingHelperMethods.ts" />
var StudyDGraphing;
StudyDGraphing = {
    Setup: function (graphdiv) {
        if (graphdiv) {
            this.graphDiv = $("#" + graphdiv);
        }
        else {
            this.graphDiv = $("#graphDiv");
        }
        // var selector = $('.sectionContent')[0];
        // GraphHelperMethods.createSvg(selector);
    },
    clearAllSets: function () {
        $('.tooMuchData').remove();
        var divs = this.graphDiv.siblings();
        if ($(divs[1]).find("svg").length == 0) {
            d3.selectAll("svg").remove();
        }
        else {
            for (var div = 1; div < divs.length; div++) {
                $(divs[div]).find("svg").remove();
            }
        }
    },
    addNewSet: function (newSet, type) {
        var buttonArr = StudyHelper.getButtonElement(this.graphDiv), selector = StudyHelper.getSelectorElement(this.graphDiv), type = StudyHelper.measurementType(type), buttons = {
            'line': buttonArr[0],
            'bar-empty': buttonArr[1],
            'bar-time': buttonArr[2],
            'bar-line': buttonArr[3],
            'bar-measurement': buttonArr[4]
        }, selectors = {
            'line': selector[1],
            'bar-time': selector[2],
            'bar-line': selector[3],
            'bar-measurement': selector[4]
        };
        /**
         * display grouped bar chart by measurement if most of the measurement types are protocol
         *  currently commented out because this is buggy
        **/
        //StudyHelper.showProteomicGraph(type, selectors, 'bar-measurement', buttons);
        //line chart
        $(buttons['line']).click(function (event) {
            event.preventDefault();
            StudyHelper.displayGraph(selectors, 'line');
            $('label.btn').removeClass('active');
            $(this).addClass('active');
            //hide graph option buttons
            $(buttons['bar-time']).addClass('hidden');
            $(buttons['bar-line']).addClass('hidden');
            $(buttons['bar-measurement']).addClass('hidden');
            return false;
        });
        // when user clicks bar button, show option buttons
        $(buttons['bar-empty']).click(function (event) {
            event.preventDefault();
            $(buttons['bar-time']).removeClass('hidden');
            $(buttons['bar-line']).removeClass('hidden');
            $(buttons['bar-measurement']).removeClass('hidden');
            $('label.btn').removeClass('active');
            $(this).addClass('active');
            return false;
        });
        //bar chart grouped by time
        $(buttons['bar-time']).click(function (event) {
            var rects = d3.selectAll('.barTime rect')[0];
            StudyHelper.buttonEventHandler(newSet, event, rects, 'bar-time', selectors, buttonArr);
        });
        //bar chart grouped by line name
        $(buttons['bar-line']).click(function (event) {
            var rects = d3.selectAll('.barAssay rect')[0];
            StudyHelper.buttonEventHandler(newSet, event, rects, 'bar-line', selectors, buttonArr);
        });
        //bar chart grouped by measurement
        $(buttons['bar-measurement']).click(function (event) {
            var rects = d3.selectAll('.barMeasurement rect')[0];
            StudyHelper.buttonEventHandler(newSet, event, rects, 'bar-measurement', selectors, buttonArr);
        });
        var barAssayObj = GraphHelperMethods.concatAssays(newSet);
        //data for graphs
        var graphSet = {
            barAssayObj: GraphHelperMethods.concatAssays(newSet),
            create_x_axis: GraphHelperMethods.createXAxis,
            create_right_y_axis: GraphHelperMethods.createRightYAxis,
            create_y_axis: GraphHelperMethods.createLeftYAxis,
            x_axis: GraphHelperMethods.make_x_axis,
            y_axis: GraphHelperMethods.make_right_y_axis,
            individualData: newSet,
            assayMeasurements: barAssayObj,
            width: 750,
            height: 220
        };
        //render different graphs
        createMultiLineGraph(graphSet, GraphHelperMethods.createSvg(selector[1]));
        createGroupedBarGraph(graphSet, GraphHelperMethods.createSvg(selector[2]), 'x');
        createGroupedBarGraph(graphSet, GraphHelperMethods.createSvg(selector[3]), 'name');
        createGroupedBarGraph(graphSet, GraphHelperMethods.createSvg(selector[4]), 'measurement');
        if (!newSet.label) {
            $('#debug').text('Failed to fetch series.');
            return;
        }
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3R1ZHlHcmFwaGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlN0dWR5R3JhcGhpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0RBQW9EO0FBQ3BELDhDQUE4QztBQUM5Qyw4Q0FBOEM7QUFDOUMsc0RBQXNEO0FBRXRELElBQUksY0FBa0IsQ0FBQztBQUt2QixjQUFjLEdBQUc7SUFFaEIsS0FBSyxFQUFDLFVBQVMsUUFBUTtRQUV0QixFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ2QsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLFFBQVEsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNQLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQzFCLENBQUM7UUFDRCwwQ0FBMEM7UUFDMUMsMENBQTBDO0lBQ2pELENBQUM7SUFFRCxZQUFZLEVBQUM7UUFDTixDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDM0IsSUFBSSxJQUFJLEdBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUVyQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFFLEtBQUssQ0FBRSxDQUFDLE1BQU0sSUFBSSxDQUFFLENBQUMsQ0FBQSxDQUFDO1lBQ3RDLEVBQUUsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDbEMsQ0FBQztRQUNELElBQUksQ0FBQyxDQUFDO1lBQ0YsR0FBRyxDQUFDLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7Z0JBQ3pDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7WUFDckMsQ0FBQztRQUNMLENBQUM7SUFDUixDQUFDO0lBRUQsU0FBUyxFQUFDLFVBQVMsTUFBTSxFQUFFLElBQUk7UUFFeEIsSUFBSSxTQUFTLEdBQUcsV0FBVyxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFDdkQsUUFBUSxHQUFHLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQ3hELElBQUksR0FBRyxXQUFXLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUN4QyxPQUFPLEdBQUc7WUFDTixNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNwQixXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUN6QixVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUN4QixVQUFVLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUN4QixpQkFBaUIsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDO1NBQ2xDLEVBQ0QsU0FBUyxHQUFHO1lBQ1IsTUFBTSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDbkIsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDdkIsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDdkIsaUJBQWlCLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQztTQUNqQyxDQUFDO1FBRU47OztXQUdHO1FBQ0gsOEVBQThFO1FBRTlFLFlBQVk7UUFDWixDQUFDLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsS0FBSztZQUNuQyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdkIsV0FBVyxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDNUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBRTNCLDJCQUEyQjtZQUMzQixDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzFDLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDMUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ2pELE1BQU0sQ0FBQyxLQUFLLENBQUE7UUFDaEIsQ0FBQyxDQUFDLENBQUM7UUFFSCxtREFBbUQ7UUFDbkQsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEtBQUs7WUFDeEMsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3ZCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM3QyxDQUFDLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDcEQsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzNCLE1BQU0sQ0FBQyxLQUFLLENBQUE7UUFDaEIsQ0FBQyxDQUFDLENBQUM7UUFFSCwyQkFBMkI7UUFDM0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFTLEtBQUs7WUFDdkMsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3QyxXQUFXLENBQUMsa0JBQWtCLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUMzRixDQUFDLENBQUMsQ0FBQztRQUVILGdDQUFnQztRQUNoQyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsS0FBSztZQUN2QyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUMsV0FBVyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDM0YsQ0FBQyxDQUFDLENBQUM7UUFFSCxrQ0FBa0M7UUFDbEMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVMsS0FBSztZQUM5QyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDcEQsV0FBVyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNsRyxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksV0FBVyxHQUFJLGtCQUFrQixDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUUzRCxpQkFBaUI7UUFDakIsSUFBSSxRQUFRLEdBQUc7WUFDWCxXQUFXLEVBQUUsa0JBQWtCLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztZQUNwRCxhQUFhLEVBQUUsa0JBQWtCLENBQUMsV0FBVztZQUM3QyxtQkFBbUIsRUFBRSxrQkFBa0IsQ0FBQyxnQkFBZ0I7WUFDeEQsYUFBYSxFQUFFLGtCQUFrQixDQUFDLGVBQWU7WUFDakQsTUFBTSxFQUFFLGtCQUFrQixDQUFDLFdBQVc7WUFDdEMsTUFBTSxFQUFFLGtCQUFrQixDQUFDLGlCQUFpQjtZQUM1QyxjQUFjLEVBQUUsTUFBTTtZQUN0QixpQkFBaUIsRUFBRSxXQUFXO1lBQzlCLEtBQUssRUFBRSxHQUFHO1lBQ1YsTUFBTSxFQUFFLEdBQUc7U0FDZCxDQUFDO1FBRUYseUJBQXlCO1FBQ3pCLG9CQUFvQixDQUFDLFFBQVEsRUFBRSxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxRSxxQkFBcUIsQ0FBQyxRQUFRLEVBQUUsa0JBQWtCLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2hGLHFCQUFxQixDQUFDLFFBQVEsRUFBRSxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDbkYscUJBQXFCLENBQUMsUUFBUSxFQUFFLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxhQUFhLENBQUMsQ0FBQztRQUVoRyxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ25CLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUM7UUFDUixDQUFDO0lBQ0YsQ0FBQztDQUVELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBGaWxlIGxhc3QgbW9kaWZpZWQgb246IFRodSBPY3QgMjcgMjAxNiAxMTo0MTo0NiAgXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwaW5ncy9kMy9kMy5kLnRzXCIvPjtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJHcmFwaEhlbHBlck1ldGhvZHMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlN0dWR5R3JhcGhpbmdIZWxwZXJNZXRob2RzLnRzXCIgLz5cblxudmFyIFN0dWR5REdyYXBoaW5nOmFueTtcblxuZGVjbGFyZSB2YXIgY3JlYXRlTXVsdGlMaW5lR3JhcGg7XG5kZWNsYXJlIHZhciBjcmVhdGVHcm91cGVkQmFyR3JhcGg7XG5cblN0dWR5REdyYXBoaW5nID0ge1xuXG5cdFNldHVwOmZ1bmN0aW9uKGdyYXBoZGl2KSB7XG5cblx0XHRpZiAoZ3JhcGhkaXYpIHtcblx0XHRcdHRoaXMuZ3JhcGhEaXYgPSAkKFwiI1wiICsgZ3JhcGhkaXYpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmdyYXBoRGl2ID0gJChcIiNncmFwaERpdlwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB2YXIgc2VsZWN0b3IgPSAkKCcuc2VjdGlvbkNvbnRlbnQnKVswXTtcbiAgICAgICAgLy8gR3JhcGhIZWxwZXJNZXRob2RzLmNyZWF0ZVN2ZyhzZWxlY3Rvcik7XG5cdH0sXG5cblx0Y2xlYXJBbGxTZXRzOmZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcudG9vTXVjaERhdGEnKS5yZW1vdmUoKTtcbiAgICAgICAgdmFyIGRpdnMgPSAgdGhpcy5ncmFwaERpdi5zaWJsaW5ncygpO1xuXG4gICAgICAgIGlmICgkKGRpdnNbMV0pLmZpbmQoIFwic3ZnXCIgKS5sZW5ndGggPT0gMCApe1xuICAgICAgICAgICAgIGQzLnNlbGVjdEFsbChcInN2Z1wiKS5yZW1vdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAodmFyIGRpdiA9IDE7IGRpdiA8IGRpdnMubGVuZ3RoOyBkaXYrKykge1xuICAgICAgICAgICAgICAgICQoZGl2c1tkaXZdKS5maW5kKFwic3ZnXCIpLnJlbW92ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblx0fSxcblxuXHRhZGROZXdTZXQ6ZnVuY3Rpb24obmV3U2V0LCB0eXBlKSB7XG5cbiAgICAgICAgdmFyIGJ1dHRvbkFyciA9IFN0dWR5SGVscGVyLmdldEJ1dHRvbkVsZW1lbnQodGhpcy5ncmFwaERpdiksXG4gICAgICAgICAgICBzZWxlY3RvciA9IFN0dWR5SGVscGVyLmdldFNlbGVjdG9yRWxlbWVudCh0aGlzLmdyYXBoRGl2KSxcbiAgICAgICAgICAgIHR5cGUgPSBTdHVkeUhlbHBlci5tZWFzdXJlbWVudFR5cGUodHlwZSksXG4gICAgICAgICAgICBidXR0b25zID0ge1xuICAgICAgICAgICAgICAgICdsaW5lJzogYnV0dG9uQXJyWzBdLFxuICAgICAgICAgICAgICAgICdiYXItZW1wdHknOiBidXR0b25BcnJbMV0sXG4gICAgICAgICAgICAgICAgJ2Jhci10aW1lJzogYnV0dG9uQXJyWzJdLFxuICAgICAgICAgICAgICAgICdiYXItbGluZSc6IGJ1dHRvbkFyclszXSxcbiAgICAgICAgICAgICAgICAnYmFyLW1lYXN1cmVtZW50JzogYnV0dG9uQXJyWzRdXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0b3JzID0ge1xuICAgICAgICAgICAgICAgICdsaW5lJzogc2VsZWN0b3JbMV0sXG4gICAgICAgICAgICAgICAgJ2Jhci10aW1lJzogc2VsZWN0b3JbMl0sXG4gICAgICAgICAgICAgICAgJ2Jhci1saW5lJzogc2VsZWN0b3JbM10sXG4gICAgICAgICAgICAgICAgJ2Jhci1tZWFzdXJlbWVudCc6IHNlbGVjdG9yWzRdXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBkaXNwbGF5IGdyb3VwZWQgYmFyIGNoYXJ0IGJ5IG1lYXN1cmVtZW50IGlmIG1vc3Qgb2YgdGhlIG1lYXN1cmVtZW50IHR5cGVzIGFyZSBwcm90b2NvbFxuICAgICAgICAgKiAgY3VycmVudGx5IGNvbW1lbnRlZCBvdXQgYmVjYXVzZSB0aGlzIGlzIGJ1Z2d5XG4gICAgICAgICoqL1xuICAgICAgICAvL1N0dWR5SGVscGVyLnNob3dQcm90ZW9taWNHcmFwaCh0eXBlLCBzZWxlY3RvcnMsICdiYXItbWVhc3VyZW1lbnQnLCBidXR0b25zKTtcblxuICAgICAgICAvL2xpbmUgY2hhcnRcbiAgICAgICAgJChidXR0b25zWydsaW5lJ10pLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgU3R1ZHlIZWxwZXIuZGlzcGxheUdyYXBoKHNlbGVjdG9ycywgJ2xpbmUnKTtcbiAgICAgICAgICAgICQoJ2xhYmVsLmJ0bicpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAvL2hpZGUgZ3JhcGggb3B0aW9uIGJ1dHRvbnNcbiAgICAgICAgICAgICQoYnV0dG9uc1snYmFyLXRpbWUnXSkuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgJChidXR0b25zWydiYXItbGluZSddKS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAkKGJ1dHRvbnNbJ2Jhci1tZWFzdXJlbWVudCddKS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gd2hlbiB1c2VyIGNsaWNrcyBiYXIgYnV0dG9uLCBzaG93IG9wdGlvbiBidXR0b25zXG4gICAgICAgICQoYnV0dG9uc1snYmFyLWVtcHR5J10pLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAkKGJ1dHRvbnNbJ2Jhci10aW1lJ10pLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICQoYnV0dG9uc1snYmFyLWxpbmUnXSkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgJChidXR0b25zWydiYXItbWVhc3VyZW1lbnQnXSkucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgJCgnbGFiZWwuYnRuJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9iYXIgY2hhcnQgZ3JvdXBlZCBieSB0aW1lXG4gICAgICAgICQoYnV0dG9uc1snYmFyLXRpbWUnXSkuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciByZWN0cyA9IGQzLnNlbGVjdEFsbCgnLmJhclRpbWUgcmVjdCcpWzBdO1xuICAgICAgICAgICAgU3R1ZHlIZWxwZXIuYnV0dG9uRXZlbnRIYW5kbGVyKG5ld1NldCwgZXZlbnQsIHJlY3RzLCAnYmFyLXRpbWUnLCBzZWxlY3RvcnMsIGJ1dHRvbkFycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vYmFyIGNoYXJ0IGdyb3VwZWQgYnkgbGluZSBuYW1lXG4gICAgICAgICQoYnV0dG9uc1snYmFyLWxpbmUnXSkuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciByZWN0cyA9IGQzLnNlbGVjdEFsbCgnLmJhckFzc2F5IHJlY3QnKVswXTtcbiAgICAgICAgICAgIFN0dWR5SGVscGVyLmJ1dHRvbkV2ZW50SGFuZGxlcihuZXdTZXQsIGV2ZW50LCByZWN0cywgJ2Jhci1saW5lJywgc2VsZWN0b3JzLCBidXR0b25BcnIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2JhciBjaGFydCBncm91cGVkIGJ5IG1lYXN1cmVtZW50XG4gICAgICAgICQoYnV0dG9uc1snYmFyLW1lYXN1cmVtZW50J10pLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcmVjdHMgPSBkMy5zZWxlY3RBbGwoJy5iYXJNZWFzdXJlbWVudCByZWN0JylbMF07XG4gICAgICAgICAgICBTdHVkeUhlbHBlci5idXR0b25FdmVudEhhbmRsZXIobmV3U2V0LCBldmVudCwgcmVjdHMsICdiYXItbWVhc3VyZW1lbnQnLCBzZWxlY3RvcnMsIGJ1dHRvbkFycik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBiYXJBc3NheU9iaiAgPSBHcmFwaEhlbHBlck1ldGhvZHMuY29uY2F0QXNzYXlzKG5ld1NldCk7XG5cbiAgICAgICAgLy9kYXRhIGZvciBncmFwaHNcbiAgICAgICAgdmFyIGdyYXBoU2V0ID0ge1xuICAgICAgICAgICAgYmFyQXNzYXlPYmo6IEdyYXBoSGVscGVyTWV0aG9kcy5jb25jYXRBc3NheXMobmV3U2V0KSxcbiAgICAgICAgICAgIGNyZWF0ZV94X2F4aXM6IEdyYXBoSGVscGVyTWV0aG9kcy5jcmVhdGVYQXhpcyxcbiAgICAgICAgICAgIGNyZWF0ZV9yaWdodF95X2F4aXM6IEdyYXBoSGVscGVyTWV0aG9kcy5jcmVhdGVSaWdodFlBeGlzLFxuICAgICAgICAgICAgY3JlYXRlX3lfYXhpczogR3JhcGhIZWxwZXJNZXRob2RzLmNyZWF0ZUxlZnRZQXhpcyxcbiAgICAgICAgICAgIHhfYXhpczogR3JhcGhIZWxwZXJNZXRob2RzLm1ha2VfeF9heGlzLFxuICAgICAgICAgICAgeV9heGlzOiBHcmFwaEhlbHBlck1ldGhvZHMubWFrZV9yaWdodF95X2F4aXMsXG4gICAgICAgICAgICBpbmRpdmlkdWFsRGF0YTogbmV3U2V0LFxuICAgICAgICAgICAgYXNzYXlNZWFzdXJlbWVudHM6IGJhckFzc2F5T2JqLFxuICAgICAgICAgICAgd2lkdGg6IDc1MCxcbiAgICAgICAgICAgIGhlaWdodDogMjIwXG4gICAgICAgIH07XG5cbiAgICAgICAgLy9yZW5kZXIgZGlmZmVyZW50IGdyYXBoc1xuICAgICAgICBjcmVhdGVNdWx0aUxpbmVHcmFwaChncmFwaFNldCwgR3JhcGhIZWxwZXJNZXRob2RzLmNyZWF0ZVN2ZyhzZWxlY3RvclsxXSkpO1xuICAgICAgICBjcmVhdGVHcm91cGVkQmFyR3JhcGgoZ3JhcGhTZXQsIEdyYXBoSGVscGVyTWV0aG9kcy5jcmVhdGVTdmcoc2VsZWN0b3JbMl0pLCAneCcpO1xuICAgICAgICBjcmVhdGVHcm91cGVkQmFyR3JhcGgoZ3JhcGhTZXQsIEdyYXBoSGVscGVyTWV0aG9kcy5jcmVhdGVTdmcoc2VsZWN0b3JbM10pLCAnbmFtZScpO1xuICAgICAgICBjcmVhdGVHcm91cGVkQmFyR3JhcGgoZ3JhcGhTZXQsIEdyYXBoSGVscGVyTWV0aG9kcy5jcmVhdGVTdmcoc2VsZWN0b3JbNF0pLCAnbWVhc3VyZW1lbnQnKTtcblxuXHRcdGlmICghbmV3U2V0LmxhYmVsKSB7XG5cdFx0XHQkKCcjZGVidWcnKS50ZXh0KCdGYWlsZWQgdG8gZmV0Y2ggc2VyaWVzLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0fSxcblxufTsiXX0=