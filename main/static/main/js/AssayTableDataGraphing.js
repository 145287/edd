// Compiled to JS on: Thu Feb 18 2016 16:47:14  
/// <reference path="typescript-declarations.d.ts" />
var EDDATDGraphing;
EDDATDGraphing = {
    graphDiv: null,
    plotObject: null,
    dataSets: [],
    tickArray: [],
    previousPoint: null,
    previousPointSeries: null,
    setsFetched: {},
    graphOptions: {
        series: {
            lines: {
                //				steps: true,
                show: true
            },
            points: {
                show: true,
                radius: 1.5,
            },
            shadowSize: 0
        },
        grid: {
            hoverable: true,
            clickable: true,
            autoHighlight: true,
            backgroundColor: "#FFF",
            borderColor: "#EEE"
        },
        crosshair: {
            mode: "x"
        },
        xaxis: {},
        yaxis: {
            zoomRange: [1, 1]
        },
        zoom: {
            interactive: false
        },
        pan: {
            interactive: false
        },
        legend: {
            show: false
        }
    },
    Setup: function () {
        EDDATDGraphing.graphDiv = $("#graphDiv");
        EDDATDGraphing.graphDiv.bind("plothover", EDDATDGraphing.hoverFunction);
        EDDATDGraphing.graphDiv.bind("plotclick", EDDATDGraphing.plotClickFunction);
        EDDATDGraphing.graphOptions.xaxis.ticks = EDDATDGraphing.tickGeneratorFunction;
        EDDATDGraphing.plotObject = $.plot(EDDATDGraphing.graphDiv, EDDATDGraphing.dataSets, EDDATDGraphing.graphOptions);
    },
    clearAllSets: function () {
        EDDATDGraphing.setsFetched = {};
    },
    addNewSet: function (newSet) {
        if (!newSet.label) {
            $('#debug').text('Failed to fetch series.');
            return;
        }
        EDDATDGraphing.setsFetched[newSet.label] = newSet;
        //		EDDATDGraphing.reassignGraphColors();
        //		EDDATDGraphing.redrawGraph();
    },
    drawSets: function () {
        EDDATDGraphing.reassignGraphColors();
        EDDATDGraphing.redrawGraph();
    },
    reassignGraphColors: function () {
        var setCount = 0; // Damn, there has to be a better way to do this.
        var activeSetCount = 0;
        for (var i in EDDATDGraphing.setsFetched) {
            setCount++;
            var oneSet = EDDATDGraphing.setsFetched[i];
            if (oneSet.data) {
                activeSetCount++;
            }
        }
        var setIndex = 0;
        for (var i in EDDATDGraphing.setsFetched) {
            var oneSet = EDDATDGraphing.setsFetched[i];
            if (oneSet.data) {
                oneSet.color = EDDATDGraphing.intAndRangeToLineColor(setIndex, activeSetCount);
                var ts = document.getElementById(oneSet.label + 'Label');
                if (ts) {
                    ts.style.backgroundColor = oneSet.color;
                    ts.style.color = '#FFF';
                }
            }
            setIndex++;
        }
    },
    intAndRangeToLineColor: function (i, r) {
        // 17 intermediate spots on the color wheel, adjusted for visibility,
        // with the 18th a clone of the 1st.
        var lineColors = [
            [0, 136, 132], [10, 136, 109], [13, 143, 45], [20, 136, 10], [72, 136, 10], [125, 136, 0],
            [136, 108, 10], [136, 73, 11], [136, 43, 14], [136, 14, 43], [136, 11, 88], [118, 13, 136],
            [89, 23, 136], [43, 20, 136], [14, 23, 136], [12, 44, 136], [13, 107, 136], [0, 136, 132]];
        // Range of 0 is just unacceptable
        if (r < 1) {
            return '#888';
        }
        // Negative index is equally unacceptable
        if (i < 0) {
            return '#888';
        }
        if (i > r) {
            i = i % r; // Make sure i is within r
        }
        var adjustedRange = (i / r) * (lineColors.length - 2);
        var lIndex = Math.floor(adjustedRange);
        var lfraction = adjustedRange - lIndex;
        var rIndex = lIndex + 1;
        var rfraction = rIndex - adjustedRange;
        //		console.log(rIndex + ' ' + lfraction + ' ' + (lineColors.length - 2));
        var r = Math.floor((lineColors[lIndex][0] * lfraction) + (lineColors[rIndex][0] * rfraction));
        var g = Math.floor((lineColors[lIndex][1] * lfraction) + (lineColors[rIndex][1] * rfraction));
        var b = Math.floor((lineColors[lIndex][2] * lfraction) + (lineColors[rIndex][2] * rfraction));
        return 'rgb(' + r + ', ' + g + ', ' + b + ')';
    },
    redrawGraph: function () {
        EDDATDGraphing.dataSets = [];
        for (var oneSet in EDDATDGraphing.setsFetched) {
            EDDATDGraphing.dataSets.push(EDDATDGraphing.setsFetched[oneSet]);
        }
        EDDATDGraphing.rebuildXAxis();
        EDDATDGraphing.plotObject = $.plot(EDDATDGraphing.graphDiv, EDDATDGraphing.dataSets, EDDATDGraphing.graphOptions);
    },
    rebuildXAxis: function () {
        EDDATDGraphing.tickArray = [];
        for (var i = 0; i < EDDATDGraphing.dataSets.length; i++) {
            var oneSeries = EDDATDGraphing.dataSets[i];
            if (oneSeries.data) {
                var di = 0;
                var ti = 0;
                var oldTickArray = EDDATDGraphing.tickArray;
                EDDATDGraphing.tickArray = [];
                while ((di < oneSeries.data.length) && (ti < oldTickArray.length)) {
                    var d = parseFloat(oneSeries.data[di][0]);
                    var t = oldTickArray[ti][0];
                    if (d == t) {
                        EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                        di++;
                        ti++;
                    }
                    if (d < t) {
                        EDDATDGraphing.tickArray.push([d, d]);
                        di++;
                    }
                    if (t < d) {
                        EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                        ti++;
                    }
                }
                while (di < oneSeries.data.length) {
                    var d = parseFloat(oneSeries.data[di][0]);
                    EDDATDGraphing.tickArray.push([d, d]);
                    di++;
                }
                while (ti < oldTickArray.length) {
                    var t = oldTickArray[ti][0];
                    EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                    ti++;
                }
            }
        }
    },
    tickGeneratorFunction: function (axis) {
        var res = [];
        if (!EDDATDGraphing.graphDiv) {
            return res;
        }
        var graphDivWidth = EDDATDGraphing.graphDiv.width();
        if (!graphDivWidth) {
            return res;
        }
        var portSize = axis.max - axis.min;
        if (portSize < 1) {
            return res;
        }
        // Hem the region in on the right side to prevent the divs from drawing offscreen
        // and summoning a horizontal scrollbar.
        var maxEdge = Math.floor(axis.max - ((portSize / graphDivWidth) * 20));
        if (maxEdge <= axis.min) {
            return res;
        }
        //		console.log("axis.max: " + axis.max + " axis.min: " + axis.min +
        //			" portSize: " + portSize + " graphDivWidth: " + graphDivWidth +
        //			" Maxedge: " + maxEdge);
        // 26 pixels is about how much screen width we need for each label.
        // The variable stepSize is the minimum distance along the x axis
        // we must step to keep the labels from overlapping.
        var stepSize = Math.floor((portSize / graphDivWidth) * 26);
        if (!EDDATDGraphing.tickArray) {
            return res;
        }
        if (stepSize < 1) {
            stepSize = 1;
        }
        // largestScale is the number of ticks on the axis we have to choose from
        var largestScale = EDDATDGraphing.tickArray.length;
        if (largestScale < 1) {
            return res;
        }
        //		console.log("stepSize: " + stepSize + " largestScale: " + largestScale);
        // This code performs a binary search down into the array,
        // hunting for the closest match to the given value
        // (the left edge of the region we are trying to place a tick in)
        var windowLeftWave = axis.min;
        var prevI = -1;
        // Hint: If this gives bizarre results, make sure you have everything
        // casted to floats or ints, instead of strings.
        do {
            var sScale = largestScale / 2;
            var i = sScale;
            do {
                var v = EDDATDGraphing.tickArray[Math.floor(i)][0];
                sScale = sScale / 2;
                if (v > windowLeftWave) {
                    i = i - sScale;
                }
                else {
                    i = i + sScale;
                }
            } while (sScale > 0.4);
            // The index is meant to end up pointing between the two values on either side
            // of our target, but may be off by one value when we quit searching due to a
            // rounding issue.  So we take the floor and test that value, and choose the one
            // just higher if it's too low.
            i = Math.floor(i);
            if (EDDATDGraphing.tickArray[i][0] < windowLeftWave) {
                i = i + 1;
            }
            // If, by seeking the higher value, we end up off the end of the array, then
            // there are no more values we can add.
            if (i >= EDDATDGraphing.tickArray.length) {
                break;
            }
            res.push([EDDATDGraphing.tickArray[i][0], EDDATDGraphing.tickArray[i][1]]);
            // Take the location of this tick, plus our scaled spacer, and use that as the
            // new left edge of our tick search.
            windowLeftWave = EDDATDGraphing.tickArray[i][0] + stepSize;
            // If, for any reason, we end up on the same index twice in a row,
            // bail out to prevent an infinite loop.
            if (i == prevI) {
                break;
            }
            prevI = i;
        } while (windowLeftWave < maxEdge);
        return res;
    },
    hoverFunction: function (event, pos, item) {
        if (item) {
            if ((EDDATDGraphing.previousPoint != item.dataIndex) ||
                (EDDATDGraphing.previousPointSeries != item.series.name)) {
                EDDATDGraphing.previousPoint = item.dataIndex;
                EDDATDGraphing.previousPointSeries = item.series.name;
                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(2), y = item.datapoint[1].toFixed(2);
                var tempconfig = '';
                if (item.series.name) {
                    tempconfig = item.series.name + ':<br>';
                }
                var tempunits = '';
                if (item.series.units) {
                    tempunits = item.series.units;
                }
                var templabel = tempconfig + '<B>' + y + '</B> ' + tempunits;
                var temptag = '';
                if (item.series.tags) {
                    if (item.series.tags[item.dataIndex]) {
                        temptag = item.series.tags[item.dataIndex][1];
                    }
                }
                if (temptag != '') {
                    templabel = templabel + '<br>' + temptag;
                }
                EDDATDGraphing.showTooltip(item.pageX + 5, item.pageY + 5, templabel, item.series.color);
            }
        }
        else {
            $("#tooltip").remove();
            EDDATDGraphing.previousPoint = null;
            EDDATDGraphing.previousPointSeries = null;
        }
    },
    showTooltip: function (x, y, contents, col) {
        var newTip = $('<div id="tooltip" class="graphToolTip">' + contents + '</div>');
        // We will place the tooltip in the location specified, unless
        // the rendered width of the content runs off right edge,
        // in which case we will shift it left to be flush with the right-edge of the window,
        // and re-write the width of the box so it conforms to the wrapping of the text.
        newTip.css({
            top: y,
            left: x
        });
        if (col) {
            newTip.css({ 'color': col });
        }
        newTip.appendTo("body");
        newTip = document.getElementById("tooltip");
        var newTipWidth = newTip.clientWidth;
        if ((x + newTipWidth + 20) > window.innerWidth) {
            // tooltip on left hand side, nasty hack to shift the label
            newTip.style.width = (newTipWidth + 2) + "px";
            newTip.style.left = (x - newTipWidth) + "px";
        }
    },
    plotClickFunction: function (event, pos, item) {
        if (item) {
            if (item.series.urls) {
                if (item.series.urls[item.dataIndex]) {
                    var tempurl = item.series.urls[item.dataIndex][1];
                    if (tempurl != '') {
                        window.location = tempurl;
                    }
                }
            }
        }
    }
};
window.addEventListener('load', EDDATDGraphing.Setup, false);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXNzYXlUYWJsZURhdGFHcmFwaGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Bc3NheVRhYmxlRGF0YUdyYXBoaW5nLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHFEQUFxRDtBQUVyRCxJQUFJLGNBQWtCLENBQUM7QUFFdkIsY0FBYyxHQUFHO0lBRWhCLFFBQVEsRUFBQyxJQUFJO0lBQ2IsVUFBVSxFQUFDLElBQUk7SUFFWixRQUFRLEVBQUMsRUFBRTtJQUNYLFNBQVMsRUFBQyxFQUFFO0lBRWYsYUFBYSxFQUFDLElBQUk7SUFDbEIsbUJBQW1CLEVBQUMsSUFBSTtJQUV4QixXQUFXLEVBQUMsRUFBRTtJQUVkLFlBQVksRUFBQztRQUNaLE1BQU0sRUFBRTtZQUNQLEtBQUssRUFBRTtnQkFDVixrQkFBa0I7Z0JBQ2QsSUFBSSxFQUFFLElBQUk7YUFDVjtZQUNELE1BQU0sRUFBRTtnQkFDUCxJQUFJLEVBQUUsSUFBSTtnQkFDVixNQUFNLEVBQUUsR0FBRzthQUNYO1lBQ0QsVUFBVSxFQUFFLENBQUM7U0FDYjtRQUNELElBQUksRUFBRTtZQUNMLFNBQVMsRUFBRSxJQUFJO1lBQ2YsU0FBUyxFQUFFLElBQUk7WUFDZixhQUFhLEVBQUUsSUFBSTtZQUNuQixlQUFlLEVBQUUsTUFBTTtZQUN2QixXQUFXLEVBQUUsTUFBTTtTQUNuQjtRQUNELFNBQVMsRUFBRTtZQUNWLElBQUksRUFBRSxHQUFHO1NBQ1Q7UUFDRCxLQUFLLEVBQUUsRUFDTjtRQUNELEtBQUssRUFBRTtZQUNOLFNBQVMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDakI7UUFDRCxJQUFJLEVBQUU7WUFDTCxXQUFXLEVBQUUsS0FBSztTQUNsQjtRQUNELEdBQUcsRUFBRTtZQUNKLFdBQVcsRUFBRSxLQUFLO1NBQ2xCO1FBQ0QsTUFBTSxFQUFFO1lBQ1AsSUFBSSxFQUFFLEtBQUs7U0FDWDtLQUNEO0lBR0QsS0FBSyxFQUFDO1FBRUwsY0FBYyxDQUFD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Q0FBQyxFQUFFLENBQUMsRUFBRSxFQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFDLEdBQUcsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBQyxHQUFHLEVBQUMsQ0FBQyxDQUFDO1lBQzdFLENBQUMsR0FBRyxFQUFDLEdBQUcsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUMsRUFBRSxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFDLEVBQUUsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUMsRUFBRSxFQUFDLEdBQUcsQ0FBQztZQUM5RSxDQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFDLEdBQUcsRUFBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBRWhGLGtDQUFrQztRQUNsQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFBQyxDQUFDO1FBRTdCLHlDQUF5QztRQUN6QyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7UUFBQyxDQUFDO1FBRTdC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QUFJO1FBQ3BDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDaEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2dCQUN0QixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN0QyxJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ2xELEVBQUUsQ0FBQyxDQUFDLE9BQU8sSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO3dCQUNuQixNQUFNLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztvQkFDM0IsQ0FBQztnQkFDRixDQUFDO1lBQ0YsQ0FBQztRQUNJLENBQUM7SUFDTCxDQUFDO0NBQ0osQ0FBQztBQUdGLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJ0eXBlc2NyaXB0LWRlY2xhcmF0aW9ucy5kLnRzXCIgLz5cblxudmFyIEVEREFUREdyYXBoaW5nOmFueTtcblxuRUREQVRER3JhcGhpbmcgPSB7XG5cblx0Z3JhcGhEaXY6bnVsbCxcblx0cGxvdE9iamVjdDpudWxsLFxuXG4gICAgZGF0YVNldHM6W10sXG4gICAgdGlja0FycmF5OltdLFxuXG5cdHByZXZpb3VzUG9pbnQ6bnVsbCxcblx0cHJldmlvdXNQb2ludFNlcmllczpudWxsLFxuXG5cdHNldHNGZXRjaGVkOnt9LFxuXG5cdGdyYXBoT3B0aW9uczp7XG5cdFx0c2VyaWVzOiB7XG5cdFx0XHRsaW5lczoge1xuLy9cdFx0XHRcdHN0ZXBzOiB0cnVlLFxuXHRcdFx0XHRzaG93OiB0cnVlXG5cdFx0XHR9LFxuXHRcdFx0cG9pbnRzOiB7XG5cdFx0XHRcdHNob3c6IHRydWUsXG5cdFx0XHRcdHJhZGl1czogMS41LFxuXHRcdFx0fSxcblx0XHRcdHNoYWRvd1NpemU6IDBcblx0XHR9LFxuXHRcdGdyaWQ6IHtcblx0XHRcdGhvdmVyYWJsZTogdHJ1ZSxcblx0XHRcdGNsaWNrYWJsZTogdHJ1ZSxcblx0XHRcdGF1dG9IaWdobGlnaHQ6IHRydWUsXG5cdFx0XHRiYWNrZ3JvdW5kQ29sb3I6IFwiI0ZGRlwiLFxuXHRcdFx0Ym9yZGVyQ29sb3I6IFwiI0VFRVwiXG5cdFx0fSxcblx0XHRjcm9zc2hhaXI6IHtcblx0XHRcdG1vZGU6IFwieFwiXG5cdFx0fSxcblx0XHR4YXhpczoge1xuXHRcdH0sXG5cdFx0eWF4aXM6IHtcblx0XHRcdHpvb21SYW5nZTogWzEsIDFdXG5cdFx0fSxcblx0XHR6b29tOiB7XG5cdFx0XHRpbnRlcmFjdGl2ZTogZmFsc2Vcblx0XHR9LFxuXHRcdHBhbjoge1xuXHRcdFx0aW50ZXJhY3RpdmU6IGZhbHNlXG5cdFx0fSxcblx0XHRsZWdlbmQ6IHtcblx0XHRcdHNob3c6IGZhbHNlXG5cdFx0fVxuXHR9LFxuXG5cblx0U2V0dXA6ZnVuY3Rpb24oKSB7XG5cblx0XHRFRERBVERHcmFwaGluZy5ncmFwaERpdiA9ICQoXCIjZ3JhcGhEaXZcIik7XG5cdFxuXHRcdEVEREFUREdyYXBoaW5nLmdyYXBoRGl2LmJpbmQoXCJwbG90aG92ZXJcIiwgRUREQVRER3JhcGhpbmcuaG92ZXJGdW5jdGlvbik7XG5cdFx0RUREQVRER3JhcGhpbmcuZ3JhcGhEaXYuYmluZChcInBsb3RjbGlja1wiLCBFRERBVERHcmFwaGluZy5wbG90Q2xpY2tGdW5jdGlvbik7XG5cdFx0RUREQVRER3JhcGhpbmcuZ3JhcGhPcHRpb25zLnhheGlzLnRpY2tzID0gRUREQVRER3JhcGhpbmcudGlja0dlbmVyYXRvckZ1bmN0aW9uO1xuXG5cdFx0RUREQVRER3JhcGhpbmcucGxvdE9iamVjdCA9ICQucGxvdChFRERBVERHcmFwaGluZy5ncmFwaERpdiwgRUREQVRER3JhcGhpbmcuZGF0YVNldHMsIEVEREFUREdyYXBoaW5nLmdyYXBoT3B0aW9ucyk7XHRcblx0fSxcblxuXG5cdGNsZWFyQWxsU2V0czpmdW5jdGlvbigpIHtcblxuXHRcdEVEREFUREdyYXBoaW5nLnNldHNGZXRjaGVkID0ge307XG5cdH0sXG5cdFxuXG5cdGFkZE5ld1NldDpmdW5jdGlvbihuZXdTZXQpIHtcblxuXHRcdGlmICghbmV3U2V0LmxhYmVsKSB7XG5cdFx0XHQkKCcjZGVidWcnKS50ZXh0KCdGYWlsZWQgdG8gZmV0Y2ggc2VyaWVzLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdEVEREFUREdyYXBoaW5nLnNldHNGZXRjaGVkW25ld1NldC5sYWJlbF0gPSBuZXdTZXQ7XG5cbi8vXHRcdEVEREFUREdyYXBoaW5nLnJlYXNzaWduR3JhcGhDb2xvcnMoKTtcbi8vXHRcdEVEREFUREdyYXBoaW5nLnJlZHJhd0dyYXBoKCk7XG5cdH0sXG5cblxuXHRkcmF3U2V0czpmdW5jdGlvbigpIHtcblx0XHRFRERBVERHcmFwaGluZy5yZWFzc2lnbkdyYXBoQ29sb3JzKCk7XG5cdFx0RUREQVRER3JhcGhpbmcucmVkcmF3R3JhcGgoKTtcblx0fSxcblxuXG5cdHJlYXNzaWduR3JhcGhDb2xvcnM6ZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHNldENvdW50ID0gMDtcdC8vIERhbW4sIHRoZXJlIGhhcyB0byBiZSBhIGJldHRlciB3YXkgdG8gZG8gdGhpcy5cblx0XHR2YXIgYWN0aXZlU2V0Q291bnQgPSAwO1xuXHRcdGZvciAodmFyIGkgaW4gRUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWQpIHtcblx0XHRcdHNldENvdW50Kys7XG5cdFx0XHR2YXIgb25lU2V0ID0gRUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWRbaV07XG5cdFx0XHRpZiAob25lU2V0LmRhdGEpIHtcblx0XHRcdFx0YWN0aXZlU2V0Q291bnQrKztcblx0XHRcdH1cblx0XHR9XG5cblx0XHR2YXIgc2V0SW5kZXggPSAwO1xuXHRcdGZvciAodmFyIGkgaW4gRUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWQpIHtcblx0XHRcdHZhciBvbmVTZXQgPSBFRERBVERHcmFwaGluZy5zZXRzRmV0Y2hlZFtpXTtcblx0XHRcdGlmIChvbmVTZXQuZGF0YSkge1xuXHRcdFx0XHRvbmVTZXQuY29sb3IgPSBFRERBVERHcmFwaGluZy5pbnRBbmRSYW5nZVRvTGluZUNvbG9yKHNldEluZGV4LCBhY3RpdmVTZXRDb3VudCk7XG5cblx0XHRcdFx0dmFyIHRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob25lU2V0LmxhYmVsICsgJ0xhYmVsJyk7XG5cdFx0XHRcdGlmICh0cykge1xuXHRcdFx0XHRcdHRzLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IG9uZVNldC5jb2xvcjtcblx0XHRcdFx0ICAgIHRzLnN0eWxlLmNvbG9yID0gJyNGRkYnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzZXRJbmRleCsrO1xuXHRcdH1cblx0fSxcblxuXG5cdGludEFuZFJhbmdlVG9MaW5lQ29sb3I6ZnVuY3Rpb24oaSxyKSB7XG5cdFx0Ly8gMTcgaW50ZXJtZWRpYXRlIHNwb3RzIG9uIHRoZSBjb2xvciB3aGVlbCwgYWRqdXN0ZWQgZm9yIHZpc2liaWxpdHksXG5cdFx0Ly8gd2l0aCB0aGUgMTh0aCBhIGNsb25lIG9mIHRoZSAxc3QuXG5cdFx0dmFyIGxpbmVDb2xvcnMgPSBbXG5cdFx0XHRbMCwxMzYsMTMyXSwgWzEwLDEzNiwxMDldLCBbMTMsMTQzLDQ1XSwgWzIwLDEzNiwxMF0sIFs3MiwxMzYsMTBdLCBbMTI1LDEzNiwwXSxcblx0XHRcdFsxMzYsMTA4LDEwXSwgWzEzNiw3MywxMV0sIFsxMzYsNDMsMTRdLCBbMTM2LDE0LDQzXSwgWzEzNiwxMSw4OF0sIFsxMTgsMTMsMTM2XSxcblx0XHRcdFs4OSwyMywxMzZdLCBbNDMsMjAsMTM2XSwgWzE0LDIzLDEzNl0sIFsxMiw0NCwxMzZdLCBbMTMsMTA3LDEzNl0sIFswLDEzNiwxMzJdXTtcblxuXHRcdC8vIFJhbmdlIG9mIDAgaXMganVzdCB1bmFjY2VwdGFibGVcblx0XHRpZiAociA8IDEpIHsgcmV0dXJuICcjODg4JzsgfVxuXG5cdFx0Ly8gTmVnYXRpdmUgaW5kZXggaXMgZXF1YWxseSB1bmFjY2VwdGFibGVcblx0XHRpZiAoaSA8IDApIHsgcmV0dXJuICcjODg4JzsgfVxuXG5cdFx0aWYgKGkgPiByKSB7XG5cdFx0XHRpID0gaSAlIHI7XHQvLyBNYWtlIHN1cmUgaSBpcyB3aXRoaW4gclxuXHRcdH1cblxuXHRcdHZhciBhZGp1c3RlZFJhbmdlID0gKGkgLyByKSAqIChsaW5lQ29sb3JzLmxlbmd0aCAtIDIpO1xuXHRcdHZhciBsSW5kZXggPSBNYXRoLmZsb29yKGFkanVzdGVkUmFuZ2UpO1xuXHRcdHZhciBsZnJhY3Rpb24gPSBhZGp1c3RlZFJhbmdlIC0gbEluZGV4O1xuXHRcdHZhciBySW5kZXggPSBsSW5kZXggKyAxO1xuXHRcdHZhciByZnJhY3Rpb24gPSBySW5kZXggLSBhZGp1c3RlZFJhbmdlO1xuLy9cdFx0Y29uc29sZS5sb2cockluZGV4ICsgJyAnICsgbGZyYWN0aW9uICsgJyAnICsgKGxpbmVDb2xvcnMubGVuZ3RoIC0gMikpO1xuXHRcdHZhciByOmFueSA9IE1hdGguZmxvb3IoKGxpbmVDb2xvcnNbbEluZGV4XVswXSAqIGxmcmFjdGlvbikgKyAobGluZUNvbG9yc1tySW5kZXhdWzBdICogcmZyYWN0aW9uKSk7XG5cdFx0dmFyIGcgPSBNYXRoLmZsb29yKChsaW5lQ29sb3JzW2xJbmRleF1bMV0gKiBsZnJhY3Rpb24pICsgKGxpbmVDb2xvcnNbckluZGV4XVsxXSAqIHJmcmFjdGlvbikpO1xuXHRcdHZhciBiID0gTWF0aC5mbG9vcigobGluZUNvbG9yc1tsSW5kZXhdWzJdICogbGZyYWN0aW9uKSArIChsaW5lQ29sb3JzW3JJbmRleF1bMl0gKiByZnJhY3Rpb24pKTtcblx0XHRcblx0XHRyZXR1cm4gJ3JnYignICsgciArICcsICcgKyBnICsgJywgJyArIGIgKyAnKSc7XG5cdH0sXG5cblxuXHRyZWRyYXdHcmFwaDpmdW5jdGlvbigpIHtcblx0XHRFRERBVERHcmFwaGluZy5kYXRhU2V0cyA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgb25lU2V0IGluIEVEREFUREdyYXBoaW5nLnNldHNGZXRjaGVkKSB7XG5cdCAgIFx0XHRFRERBVERHcmFwaGluZy5kYXRhU2V0cy5wdXNoKEVEREFUREdyYXBoaW5nLnNldHNGZXRjaGVkW29uZVNldF0pO1xuXHRcdH1cblxuXHRcdEVEREFUREdyYXBoaW5nLnJlYnVpbGRYQXhpcygpO1xuXG5cdFx0RUREQVRER3JhcGhpbmcucGxvdE9iamVjdCA9ICQucGxvdChFRERBVERHcmFwaGluZy5ncmFwaERpdiwgRUREQVRER3JhcGhpbmcuZGF0YVNldHMsIEVEREFUREdyYXBoaW5nLmdyYXBoT3B0aW9ucyk7XG5cdH0sXG5cblxuXHRyZWJ1aWxkWEF4aXM6ZnVuY3Rpb24oKSB7XG5cdFxuXHRcdEVEREFUREdyYXBoaW5nLnRpY2tBcnJheSA9IFtdO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBFRERBVERHcmFwaGluZy5kYXRhU2V0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIG9uZVNlcmllcyA9IEVEREFUREdyYXBoaW5nLmRhdGFTZXRzW2ldO1xuXG5cdFx0XHRpZiAob25lU2VyaWVzLmRhdGEpIHtcblx0XHRcdFx0dmFyIGRpID0gMDtcblx0XHRcdFx0dmFyIHRpID0gMDtcblx0XHRcdFx0dmFyIG9sZFRpY2tBcnJheSA9IEVEREFUREdyYXBoaW5nLnRpY2tBcnJheTtcblx0XHRcdFx0RUREQVRER3JhcGhpbmcudGlja0FycmF5ID0gW107XG5cblx0XHRcdFx0d2hpbGUgKChkaSA8IG9uZVNlcmllcy5kYXRhLmxlbmd0aCkgJiYgKHRpIDwgb2xkVGlja0FycmF5Lmxlbmd0aCkpIHtcblx0XHRcdFx0XHR2YXIgZCA9IHBhcnNlRmxvYXQob25lU2VyaWVzLmRhdGFbZGldWzBdKTtcblx0XHRcdFx0XHR2YXIgdCA9IG9sZFRpY2tBcnJheVt0aV1bMF07XG5cdFx0XHRcdFx0aWYgKGQgPT0gdCkge1xuXHRcdFx0XHRcdFx0RUREQVRER3JhcGhpbmcudGlja0FycmF5LnB1c2goW3QsIG9sZFRpY2tBcnJheVt0aV1bMV1dKTtcblx0XHRcdFx0XHRcdGRpKys7XG5cdFx0XHRcdFx0XHR0aSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZCA8IHQpIHtcblx0XHRcdFx0XHRcdEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5wdXNoKFtkLCBkXSk7XG5cdFx0XHRcdFx0XHRkaSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAodCA8IGQpIHtcblx0XHRcdFx0XHRcdEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5wdXNoKFt0LCBvbGRUaWNrQXJyYXlbdGldWzFdXSk7XG5cdFx0XHRcdFx0XHR0aSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR3aGlsZSAoZGkgPCBvbmVTZXJpZXMuZGF0YS5sZW5ndGgpIHtcblx0XHRcdFx0XHR2YXIgZCA9IHBhcnNlRmxvYXQob25lU2VyaWVzLmRhdGFbZGldWzBdKTtcblx0XHRcdFx0XHRFRERBVERHcmFwaGluZy50aWNrQXJyYXkucHVzaChbZCwgZF0pO1xuXHRcdFx0XHRcdGRpKys7XG5cdFx0XHRcdH1cblx0XHRcdFx0d2hpbGUgKHRpIDwgb2xkVGlja0FycmF5Lmxlbmd0aCkge1xuXHRcdFx0XHRcdHZhciB0ID0gb2xkVGlja0FycmF5W3RpXVswXTtcblx0XHRcdFx0XHRFRERBVERHcmFwaGluZy50aWNrQXJyYXkucHVzaChbdCwgb2xkVGlja0FycmF5W3RpXVsxXV0pO1xuXHRcdFx0XHRcdHRpKys7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0sXHRcblxuXG5cdHRpY2tHZW5lcmF0b3JGdW5jdGlvbjpmdW5jdGlvbihheGlzKSB7XG5cdCAgICB2YXIgcmVzID0gW107XG5cdCAgICBpZiAoIUVEREFUREdyYXBoaW5nLmdyYXBoRGl2KSB7XG5cdCAgICBcdHJldHVybiByZXM7XG5cdCAgICB9XG5cdCAgICB2YXIgZ3JhcGhEaXZXaWR0aCA9IEVEREFUREdyYXBoaW5nLmdyYXBoRGl2LndpZHRoKCk7XG5cdCAgICBpZiAoIWdyYXBoRGl2V2lkdGgpIHtcblx0ICAgIFx0cmV0dXJuIHJlcztcblx0ICAgIH1cblxuXHRcdHZhciBwb3J0U2l6ZSA9IGF4aXMubWF4IC0gYXhpcy5taW47XG5cdFx0aWYgKHBvcnRTaXplIDwgMSkge1xuXHRcdFx0cmV0dXJuIHJlcztcblx0XHR9XG5cblx0XHQvLyBIZW0gdGhlIHJlZ2lvbiBpbiBvbiB0aGUgcmlnaHQgc2lkZSB0byBwcmV2ZW50IHRoZSBkaXZzIGZyb20gZHJhd2luZyBvZmZzY3JlZW5cblx0XHQvLyBhbmQgc3VtbW9uaW5nIGEgaG9yaXpvbnRhbCBzY3JvbGxiYXIuXG5cdFx0dmFyIG1heEVkZ2UgPSBNYXRoLmZsb29yKGF4aXMubWF4IC0gKChwb3J0U2l6ZSAvIGdyYXBoRGl2V2lkdGgpICogMjApKTtcblx0XHRpZiAobWF4RWRnZSA8PSBheGlzLm1pbikge1xuXHRcdFx0cmV0dXJuIHJlcztcblx0XHR9XG5cbi8vXHRcdGNvbnNvbGUubG9nKFwiYXhpcy5tYXg6IFwiICsgYXhpcy5tYXggKyBcIiBheGlzLm1pbjogXCIgKyBheGlzLm1pbiArXG4vL1x0XHRcdFwiIHBvcnRTaXplOiBcIiArIHBvcnRTaXplICsgXCIgZ3JhcGhEaXZXaWR0aDogXCIgKyBncmFwaERpdldpZHRoICtcbi8vXHRcdFx0XCIgTWF4ZWRnZTogXCIgKyBtYXhFZGdlKTtcblxuXHRcdC8vIDI2IHBpeGVscyBpcyBhYm91dCBob3cgbXVjaCBzY3JlZW4gd2lkdGggd2UgbmVlZCBmb3IgZWFjaCBsYWJlbC5cblx0XHQvLyBUaGUgdmFyaWFibGUgc3RlcFNpemUgaXMgdGhlIG1pbmltdW0gZGlzdGFuY2UgYWxvbmcgdGhlIHggYXhpc1xuXHRcdC8vIHdlIG11c3Qgc3RlcCB0byBrZWVwIHRoZSBsYWJlbHMgZnJvbSBvdmVybGFwcGluZy5cblx0XHR2YXIgc3RlcFNpemUgPSBNYXRoLmZsb29yKChwb3J0U2l6ZSAvIGdyYXBoRGl2V2lkdGgpICogMjYpO1xuXHRcdGlmICghRUREQVRER3JhcGhpbmcudGlja0FycmF5KSB7XG5cdFx0XHRyZXR1cm4gcmVzO1xuXHRcdH1cblx0XHRpZiAoc3RlcFNpemUgPCAxKSB7IC8vIFN0ZXAgc2l6ZSBvZiBsZXNzIHRoYW4gb25lIHdvdWxkIG5vdCBhZHZhbmNlIHRocm91Z2ggdGhlIGFycmF5IGF0IGFsbCFcblx0XHRcdHN0ZXBTaXplID0gMTtcblx0XHR9XG5cdFx0Ly8gbGFyZ2VzdFNjYWxlIGlzIHRoZSBudW1iZXIgb2YgdGlja3Mgb24gdGhlIGF4aXMgd2UgaGF2ZSB0byBjaG9vc2UgZnJvbVxuXHRcdHZhciBsYXJnZXN0U2NhbGUgPSBFRERBVERHcmFwaGluZy50aWNrQXJyYXkubGVuZ3RoO1xuXHRcdGlmIChsYXJnZXN0U2NhbGUgPCAxKSB7XG5cdFx0XHRyZXR1cm4gcmVzO1xuXHRcdH1cblxuLy9cdFx0Y29uc29sZS5sb2coXCJzdGVwU2l6ZTogXCIgKyBzdGVwU2l6ZSArIFwiIGxhcmdlc3RTY2FsZTogXCIgKyBsYXJnZXN0U2NhbGUpO1xuXG5cdFx0Ly8gVGhpcyBjb2RlIHBlcmZvcm1zIGEgYmluYXJ5IHNlYXJjaCBkb3duIGludG8gdGhlIGFycmF5LFxuXHRcdC8vIGh1bnRpbmcgZm9yIHRoZSBjbG9zZXN0IG1hdGNoIHRvIHRoZSBnaXZlbiB2YWx1ZVxuXHRcdC8vICh0aGUgbGVmdCBlZGdlIG9mIHRoZSByZWdpb24gd2UgYXJlIHRyeWluZyB0byBwbGFjZSBhIHRpY2sgaW4pXG5cblx0XHR2YXIgd2luZG93TGVmdFdhdmUgPSBheGlzLm1pbjtcblx0XHR2YXIgcHJldkkgPSAtMTtcblxuXHRcdC8vIEhpbnQ6IElmIHRoaXMgZ2l2ZXMgYml6YXJyZSByZXN1bHRzLCBtYWtlIHN1cmUgeW91IGhhdmUgZXZlcnl0aGluZ1xuXHRcdC8vIGNhc3RlZCB0byBmbG9hdHMgb3IgaW50cywgaW5zdGVhZCBvZiBzdHJpbmdzLlxuXG5cdFx0ZG8ge1xuXG5cdFx0XHR2YXIgc1NjYWxlID0gbGFyZ2VzdFNjYWxlIC8gMjtcblx0XHRcdHZhciBpID0gc1NjYWxlO1xuXHRcdFx0ZG8ge1xuXHRcdFx0XHR2YXIgdiA9IEVEREFUREdyYXBoaW5nLnRpY2tBcnJheVtNYXRoLmZsb29yKGkpXVswXTtcblx0XHRcdFx0c1NjYWxlID0gc1NjYWxlIC8gMjtcblx0XHRcdFx0aWYgKHYgPiB3aW5kb3dMZWZ0V2F2ZSkge1xuXHRcdFx0XHRcdGkgPSBpIC0gc1NjYWxlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGkgPSBpICsgc1NjYWxlO1xuXHRcdFx0XHR9XG4vL1x0XHRcdFx0Y29uc29sZS5sb2coXCJ2OiBcIiArIHYgKyBcIiBpOiBcIiArIGkgKyBcIiBzU2NhbGU6IFwiICsgc1NjYWxlKTtcdFx0XHRcdFxuXHRcdFx0fSB3aGlsZSAoc1NjYWxlID4gMC40KTtcblxuXHRcdFx0Ly8gVGhlIGluZGV4IGlzIG1lYW50IHRvIGVuZCB1cCBwb2ludGluZyBiZXR3ZWVuIHRoZSB0d28gdmFsdWVzIG9uIGVpdGhlciBzaWRlXG5cdFx0XHQvLyBvZiBvdXIgdGFyZ2V0LCBidXQgbWF5IGJlIG9mZiBieSBvbmUgdmFsdWUgd2hlbiB3ZSBxdWl0IHNlYXJjaGluZyBkdWUgdG8gYVxuXHRcdFx0Ly8gcm91bmRpbmcgaXNzdWUuICBTbyB3ZSB0YWtlIHRoZSBmbG9vciBhbmQgdGVzdCB0aGF0IHZhbHVlLCBhbmQgY2hvb3NlIHRoZSBvbmVcblx0XHRcdC8vIGp1c3QgaGlnaGVyIGlmIGl0J3MgdG9vIGxvdy5cblx0XHRcdGkgPSBNYXRoLmZsb29yKGkpO1xuXHRcdFx0aWYgKEVEREFUREdyYXBoaW5nLnRpY2tBcnJheVtpXVswXSA8IHdpbmRvd0xlZnRXYXZlKSB7XG5cdFx0XHRcdGkgPSBpICsgMTtcblx0XHRcdH1cblx0XG5cdFx0XHQvLyBJZiwgYnkgc2Vla2luZyB0aGUgaGlnaGVyIHZhbHVlLCB3ZSBlbmQgdXAgb2ZmIHRoZSBlbmQgb2YgdGhlIGFycmF5LCB0aGVuXG5cdFx0XHQvLyB0aGVyZSBhcmUgbm8gbW9yZSB2YWx1ZXMgd2UgY2FuIGFkZC5cblx0XHRcdGlmIChpID49IEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5sZW5ndGgpIHtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJlcy5wdXNoKFtFRERBVERHcmFwaGluZy50aWNrQXJyYXlbaV1bMF0sIEVEREFUREdyYXBoaW5nLnRpY2tBcnJheVtpXVsxXV0pO1xuXHRcblx0XHRcdC8vIFRha2UgdGhlIGxvY2F0aW9uIG9mIHRoaXMgdGljaywgcGx1cyBvdXIgc2NhbGVkIHNwYWNlciwgYW5kIHVzZSB0aGF0IGFzIHRoZVxuXHRcdFx0Ly8gbmV3IGxlZnQgZWRnZSBvZiBvdXIgdGljayBzZWFyY2guXG5cdFx0XHR3aW5kb3dMZWZ0V2F2ZSA9IEVEREFUREdyYXBoaW5nLnRpY2tBcnJheVtpXVswXSArIHN0ZXBTaXplO1xuXG5cdFx0XHQvLyBJZiwgZm9yIGFueSByZWFzb24sIHdlIGVuZCB1cCBvbiB0aGUgc2FtZSBpbmRleCB0d2ljZSBpbiBhIHJvdyxcblx0XHRcdC8vIGJhaWwgb3V0IHRvIHByZXZlbnQgYW4gaW5maW5pdGUgbG9vcC5cblx0XHRcdGlmIChpID09IHByZXZJKSB7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRwcmV2SSA9IGk7XG5cblx0XHR9IHdoaWxlICh3aW5kb3dMZWZ0V2F2ZSA8IG1heEVkZ2UpO1xuXG5cdFx0cmV0dXJuIHJlcztcblx0fSxcblx0XG4gICAgXG4gICAgaG92ZXJGdW5jdGlvbjpmdW5jdGlvbihldmVudCwgcG9zLCBpdGVtKSB7XG5cdFx0aWYgKGl0ZW0pIHtcblx0XHRcdGlmICgoRUREQVRER3JhcGhpbmcucHJldmlvdXNQb2ludCAhPSBpdGVtLmRhdGFJbmRleCkgfHxcblx0XHRcdFx0KEVEREFUREdyYXBoaW5nLnByZXZpb3VzUG9pbnRTZXJpZXMgIT0gaXRlbS5zZXJpZXMubmFtZSkpIHtcblx0XHRcdFx0RUREQVRER3JhcGhpbmcucHJldmlvdXNQb2ludCA9IGl0ZW0uZGF0YUluZGV4O1xuXHRcdFx0XHRFRERBVERHcmFwaGluZy5wcmV2aW91c1BvaW50U2VyaWVzID0gaXRlbS5zZXJpZXMubmFtZTtcblxuXHRcdFx0XHQkKFwiI3Rvb2x0aXBcIikucmVtb3ZlKCk7XG5cdFx0XHRcdHZhciB4ID0gaXRlbS5kYXRhcG9pbnRbMF0udG9GaXhlZCgyKSxcblx0XHRcdFx0XHR5ID0gaXRlbS5kYXRhcG9pbnRbMV0udG9GaXhlZCgyKTtcblx0XHRcdFx0dmFyIHRlbXBjb25maWcgPSAnJztcblx0XHRcdFx0aWYgKGl0ZW0uc2VyaWVzLm5hbWUpIHtcblx0XHRcdFx0XHR0ZW1wY29uZmlnID0gaXRlbS5zZXJpZXMubmFtZSArICc6PGJyPic7XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHRlbXB1bml0cyA9ICcnO1xuXHRcdFx0XHRpZiAoaXRlbS5zZXJpZXMudW5pdHMpIHtcblx0XHRcdFx0XHR0ZW1wdW5pdHMgPSBpdGVtLnNlcmllcy51bml0cztcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgdGVtcGxhYmVsID0gdGVtcGNvbmZpZyArICc8Qj4nICsgeSArICc8L0I+ICcgKyB0ZW1wdW5pdHM7XG5cdFx0XHRcdHZhciB0ZW1wdGFnID0gJyc7XG5cdFx0XHRcdGlmIChpdGVtLnNlcmllcy50YWdzKSB7XG5cdFx0XHRcdFx0aWYgKGl0ZW0uc2VyaWVzLnRhZ3NbaXRlbS5kYXRhSW5kZXhdKSB7XG5cdFx0XHRcdFx0XHR0ZW1wdGFnID0gaXRlbS5zZXJpZXMudGFnc1tpdGVtLmRhdGFJbmRleF1bMV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh0ZW1wdGFnICE9ICcnKSB7XG5cdFx0XHRcdFx0dGVtcGxhYmVsID0gdGVtcGxhYmVsICsgJzxicj4nICsgdGVtcHRhZztcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0RUREQVRER3JhcGhpbmcuc2hvd1Rvb2x0aXAoaXRlbS5wYWdlWCArIDUsIGl0ZW0ucGFnZVkgKyA1LCB0ZW1wbGFiZWwsIGl0ZW0uc2VyaWVzLmNvbG9yKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0JChcIiN0b29sdGlwXCIpLnJlbW92ZSgpO1xuXHRcdFx0RUREQVRER3JhcGhpbmcucHJldmlvdXNQb2ludCA9IG51bGw7ICAgICAgICAgICAgXG5cdFx0XHRFRERBVERHcmFwaGluZy5wcmV2aW91c1BvaW50U2VyaWVzID0gbnVsbDsgICAgICAgICAgICBcblx0XHR9XG4gICAgfSxcblxuXG4gICAgc2hvd1Rvb2x0aXA6ZnVuY3Rpb24oeCwgeSwgY29udGVudHMsIGNvbCkge1xuICAgICAgICB2YXIgbmV3VGlwOmFueSA9ICQoJzxkaXYgaWQ9XCJ0b29sdGlwXCIgY2xhc3M9XCJncmFwaFRvb2xUaXBcIj4nICsgY29udGVudHMgKyAnPC9kaXY+Jyk7XG5cblx0XHQvLyBXZSB3aWxsIHBsYWNlIHRoZSB0b29sdGlwIGluIHRoZSBsb2NhdGlvbiBzcGVjaWZpZWQsIHVubGVzc1xuXHRcdC8vIHRoZSByZW5kZXJlZCB3aWR0aCBvZiB0aGUgY29udGVudCBydW5zIG9mZiByaWdodCBlZGdlLFxuXHRcdC8vIGluIHdoaWNoIGNhc2Ugd2Ugd2lsbCBzaGlmdCBpdCBsZWZ0IHRvIGJlIGZsdXNoIHdpdGggdGhlIHJpZ2h0LWVkZ2Ugb2YgdGhlIHdpbmRvdyxcblx0XHQvLyBhbmQgcmUtd3JpdGUgdGhlIHdpZHRoIG9mIHRoZSBib3ggc28gaXQgY29uZm9ybXMgdG8gdGhlIHdyYXBwaW5nIG9mIHRoZSB0ZXh0LlxuXG4gICAgICAgIG5ld1RpcC5jc3MoIHtcbiAgICAgICAgICAgIHRvcDogeSxcbiAgICAgICAgICAgIGxlZnQ6IHhcbiAgICAgICAgfSk7XG5cblx0XHRpZiAoY29sKSB7XG5cdCAgICAgICAgbmV3VGlwLmNzcyggeyAnY29sb3InOiBjb2wgfSk7XG5cdFx0fVxuXG5cdFx0bmV3VGlwLmFwcGVuZFRvKFwiYm9keVwiKTtcblxuXHRcdG5ld1RpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidG9vbHRpcFwiKTtcblx0XHR2YXIgbmV3VGlwV2lkdGggPSBuZXdUaXAuY2xpZW50V2lkdGg7XG5cblx0XHRpZiAoKHggKyBuZXdUaXBXaWR0aCArIDIwKSA+IHdpbmRvdy5pbm5lcldpZHRoKSB7XG5cdFx0XHQvLyB0b29sdGlwIG9uIGxlZnQgaGFuZCBzaWRlLCBuYXN0eSBoYWNrIHRvIHNoaWZ0IHRoZSBsYWJlbFxuXHRcdFx0bmV3VGlwLnN0eWxlLndpZHRoID0gKG5ld1RpcFdpZHRoKzIpICsgXCJweFwiO1xuXHRcdFx0bmV3VGlwLnN0eWxlLmxlZnQgPSAoeCAtIG5ld1RpcFdpZHRoKSArIFwicHhcIjtcblx0XHR9XG4gICAgfSxcblxuXG5cdHBsb3RDbGlja0Z1bmN0aW9uOmZ1bmN0aW9uKGV2ZW50LCBwb3MsIGl0ZW0pIHtcbiAgICAgICAgaWYgKGl0ZW0pIHtcblx0XHRcdGlmIChpdGVtLnNlcmllcy51cmxzKSB7XG5cdFx0XHRcdGlmIChpdGVtLnNlcmllcy51cmxzW2l0ZW0uZGF0YUluZGV4XSkge1xuXHRcdFx0XHRcdHZhciB0ZW1wdXJsID0gaXRlbS5zZXJpZXMudXJsc1tpdGVtLmRhdGFJbmRleF1bMV07XG5cdFx0XHRcdFx0aWYgKHRlbXB1cmwgIT0gJycpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbiA9IHRlbXB1cmw7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgRUREQVRER3JhcGhpbmcuU2V0dXAsIGZhbHNlKTsiXX0=