/// <reference path="typescript-declarations.d.ts" />
var EDDATDGraphing;
EDDATDGraphing = {
    graphDiv: null,
    plotObject: null,
    dataSets: [],
    tickArray: [],
    previousPoint: null,
    previousPointSeries: null,
    setsFetched: {},
    graphOptions: {
        series: {
            lines: {
                //				steps: true,
                show: true
            },
            points: {
                show: true,
                radius: 1.5,
            },
            shadowSize: 0
        },
        grid: {
            hoverable: true,
            clickable: true,
            autoHighlight: true,
            backgroundColor: "#FFF",
            borderColor: "#EEE"
        },
        crosshair: {
            mode: "x"
        },
        xaxis: {},
        yaxis: {
            zoomRange: [1, 1]
        },
        zoom: {
            interactive: false
        },
        pan: {
            interactive: false
        },
        legend: {
            show: false
        }
    },
    Setup: function () {
        EDDATDGraphing.graphDiv = $("#graphDiv");
        EDDATDGraphing.graphDiv.bind("plothover", EDDATDGraphing.hoverFunction);
        EDDATDGraphing.graphDiv.bind("plotclick", EDDATDGraphing.plotClickFunction);
        EDDATDGraphing.graphOptions.xaxis.ticks = EDDATDGraphing.tickGeneratorFunction;
        EDDATDGraphing.plotObject = $.plot(EDDATDGraphing.graphDiv, EDDATDGraphing.dataSets, EDDATDGraphing.graphOptions);
    },
    clearAllSets: function () {
        EDDATDGraphing.setsFetched = {};
    },
    addNewSet: function (newSet) {
        if (!newSet.label) {
            $('#debug').text('Failed to fetch series.');
            return;
        }
        EDDATDGraphing.setsFetched[newSet.label] = newSet;
        //		EDDATDGraphing.reassignGraphColors();
        //		EDDATDGraphing.redrawGraph();
    },
    drawSets: function () {
        EDDATDGraphing.reassignGraphColors();
        EDDATDGraphing.redrawGraph();
    },
    reassignGraphColors: function () {
        var setCount = 0; // Damn, there has to be a better way to do this.
        var activeSetCount = 0;
        for (var i in EDDATDGraphing.setsFetched) {
            setCount++;
            var oneSet = EDDATDGraphing.setsFetched[i];
            if (oneSet.data) {
                activeSetCount++;
            }
        }
        var setIndex = 0;
        for (var i in EDDATDGraphing.setsFetched) {
            var oneSet = EDDATDGraphing.setsFetched[i];
            if (oneSet.data) {
                oneSet.color = EDDATDGraphing.intAndRangeToLineColor(setIndex, activeSetCount);
                var ts = document.getElementById(oneSet.label + 'Label');
                if (ts) {
                    ts.style.backgroundColor = oneSet.color;
                    ts.style.color = '#FFF';
                }
            }
            setIndex++;
        }
    },
    intAndRangeToLineColor: function (i, r) {
        // 17 intermediate spots on the color wheel, adjusted for visibility,
        // with the 18th a clone of the 1st.
        var lineColors = [
            [0, 136, 132], [10, 136, 109], [13, 143, 45], [20, 136, 10], [72, 136, 10], [125, 136, 0],
            [136, 108, 10], [136, 73, 11], [136, 43, 14], [136, 14, 43], [136, 11, 88], [118, 13, 136],
            [89, 23, 136], [43, 20, 136], [14, 23, 136], [12, 44, 136], [13, 107, 136], [0, 136, 132]];
        // Range of 0 is just unacceptable
        if (r < 1) {
            return '#888';
        }
        // Negative index is equally unacceptable
        if (i < 0) {
            return '#888';
        }
        if (i > r) {
            i = i % r; // Make sure i is within r
        }
        var adjustedRange = (i / r) * (lineColors.length - 2);
        var lIndex = Math.floor(adjustedRange);
        var lfraction = adjustedRange - lIndex;
        var rIndex = lIndex + 1;
        var rfraction = rIndex - adjustedRange;
        //		console.log(rIndex + ' ' + lfraction + ' ' + (lineColors.length - 2));
        var r = Math.floor((lineColors[lIndex][0] * lfraction) + (lineColors[rIndex][0] * rfraction));
        var g = Math.floor((lineColors[lIndex][1] * lfraction) + (lineColors[rIndex][1] * rfraction));
        var b = Math.floor((lineColors[lIndex][2] * lfraction) + (lineColors[rIndex][2] * rfraction));
        return 'rgb(' + r + ', ' + g + ', ' + b + ')';
    },
    redrawGraph: function () {
        EDDATDGraphing.dataSets = [];
        for (var oneSet in EDDATDGraphing.setsFetched) {
            EDDATDGraphing.dataSets.push(EDDATDGraphing.setsFetched[oneSet]);
        }
        EDDATDGraphing.rebuildXAxis();
        EDDATDGraphing.plotObject = $.plot(EDDATDGraphing.graphDiv, EDDATDGraphing.dataSets, EDDATDGraphing.graphOptions);
    },
    rebuildXAxis: function () {
        EDDATDGraphing.tickArray = [];
        for (var i = 0; i < EDDATDGraphing.dataSets.length; i++) {
            var oneSeries = EDDATDGraphing.dataSets[i];
            if (oneSeries.data) {
                var di = 0;
                var ti = 0;
                var oldTickArray = EDDATDGraphing.tickArray;
                EDDATDGraphing.tickArray = [];
                while ((di < oneSeries.data.length) && (ti < oldTickArray.length)) {
                    var d = parseFloat(oneSeries.data[di][0]);
                    var t = oldTickArray[ti][0];
                    if (d == t) {
                        EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                        di++;
                        ti++;
                    }
                    if (d < t) {
                        EDDATDGraphing.tickArray.push([d, d]);
                        di++;
                    }
                    if (t < d) {
                        EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                        ti++;
                    }
                }
                while (di < oneSeries.data.length) {
                    var d = parseFloat(oneSeries.data[di][0]);
                    EDDATDGraphing.tickArray.push([d, d]);
                    di++;
                }
                while (ti < oldTickArray.length) {
                    var t = oldTickArray[ti][0];
                    EDDATDGraphing.tickArray.push([t, oldTickArray[ti][1]]);
                    ti++;
                }
            }
        }
    },
    tickGeneratorFunction: function (axis) {
        var res = [];
        if (!EDDATDGraphing.graphDiv) {
            return res;
        }
        var graphDivWidth = EDDATDGraphing.graphDiv.width();
        if (!graphDivWidth) {
            return res;
        }
        var portSize = axis.max - axis.min;
        if (portSize < 1) {
            return res;
        }
        // Hem the region in on the right side to prevent the divs from drawing offscreen
        // and summoning a horizontal scrollbar.
        var maxEdge = Math.floor(axis.max - ((portSize / graphDivWidth) * 20));
        if (maxEdge <= axis.min) {
            return res;
        }
        //		console.log("axis.max: " + axis.max + " axis.min: " + axis.min +
        //			" portSize: " + portSize + " graphDivWidth: " + graphDivWidth +
        //			" Maxedge: " + maxEdge);
        // 26 pixels is about how much screen width we need for each label.
        // The variable stepSize is the minimum distance along the x axis
        // we must step to keep the labels from overlapping.
        var stepSize = Math.floor((portSize / graphDivWidth) * 26);
        if (!EDDATDGraphing.tickArray) {
            return res;
        }
        if (stepSize < 1) {
            stepSize = 1;
        }
        // largestScale is the number of ticks on the axis we have to choose from
        var largestScale = EDDATDGraphing.tickArray.length;
        if (largestScale < 1) {
            return res;
        }
        //		console.log("stepSize: " + stepSize + " largestScale: " + largestScale);
        // This code performs a binary search down into the array,
        // hunting for the closest match to the given value
        // (the left edge of the region we are trying to place a tick in)
        var windowLeftWave = axis.min;
        var prevI = -1;
        // Hint: If this gives bizarre results, make sure you have everything
        // casted to floats or ints, instead of strings.
        do {
            var sScale = largestScale / 2;
            var i = sScale;
            do {
                var v = EDDATDGraphing.tickArray[Math.floor(i)][0];
                sScale = sScale / 2;
                if (v > windowLeftWave) {
                    i = i - sScale;
                }
                else {
                    i = i + sScale;
                }
            } while (sScale > 0.4);
            // The index is meant to end up pointing between the two values on either side
            // of our target, but may be off by one value when we quit searching due to a
            // rounding issue.  So we take the floor and test that value, and choose the one
            // just higher if it's too low.
            i = Math.floor(i);
            if (EDDATDGraphing.tickArray[i][0] < windowLeftWave) {
                i = i + 1;
            }
            // If, by seeking the higher value, we end up off the end of the array, then
            // there are no more values we can add.
            if (i >= EDDATDGraphing.tickArray.length) {
                break;
            }
            res.push([EDDATDGraphing.tickArray[i][0], EDDATDGraphing.tickArray[i][1]]);
            // Take the location of this tick, plus our scaled spacer, and use that as the
            // new left edge of our tick search.
            windowLeftWave = EDDATDGraphing.tickArray[i][0] + stepSize;
            // If, for any reason, we end up on the same index twice in a row,
            // bail out to prevent an infinite loop.
            if (i == prevI) {
                break;
            }
            prevI = i;
        } while (windowLeftWave < maxEdge);
        return res;
    },
    hoverFunction: function (event, pos, item) {
        if (item) {
            if ((EDDATDGraphing.previousPoint != item.dataIndex) ||
                (EDDATDGraphing.previousPointSeries != item.series.name)) {
                EDDATDGraphing.previousPoint = item.dataIndex;
                EDDATDGraphing.previousPointSeries = item.series.name;
                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(2), y = item.datapoint[1].toFixed(2);
                var tempconfig = '';
                if (item.series.name) {
                    tempconfig = item.series.name + ':<br>';
                }
                var tempunits = '';
                if (item.series.units) {
                    tempunits = item.series.units;
                }
                var templabel = tempconfig + '<B>' + y + '</B> ' + tempunits;
                var temptag = '';
                if (item.series.tags) {
                    if (item.series.tags[item.dataIndex]) {
                        temptag = item.series.tags[item.dataIndex][1];
                    }
                }
                if (temptag != '') {
                    templabel = templabel + '<br>' + temptag;
                }
                EDDATDGraphing.showTooltip(item.pageX + 5, item.pageY + 5, templabel, item.series.color);
            }
        }
        else {
            $("#tooltip").remove();
            EDDATDGraphing.previousPoint = null;
            EDDATDGraphing.previousPointSeries = null;
        }
    },
    showTooltip: function (x, y, contents, col) {
        var newTip = $('<div id="tooltip" class="graphToolTip">' + contents + '</div>');
        // We will place the tooltip in the location specified, unless
        // the rendered width of the content runs off right edge,
        // in which case we will shift it left to be flush with the right-edge of the window,
        // and re-write the width of the box so it conforms to the wrapping of the text.
        newTip.css({
            top: y,
            left: x
        });
        if (col) {
            newTip.css({ 'color': col });
        }
        newTip.appendTo("body");
        newTip = document.getElementById("tooltip");
        var newTipWidth = newTip.clientWidth;
        if ((x + newTipWidth + 20) > window.innerWidth) {
            // tooltip on left hand side, nasty hack to shift the label
            newTip.style.width = (newTipWidth + 2) + "px";
            newTip.style.left = (x - newTipWidth) + "px";
        }
    },
    plotClickFunction: function (event, pos, item) {
        if (item) {
            if (item.series.urls) {
                if (item.series.urls[item.dataIndex]) {
                    var tempurl = item.series.urls[item.dataIndex][1];
                    if (tempurl != '') {
                        window.location = tempurl;
                    }
                }
            }
        }
    }
};
window.addEventListener('load', EDDATDGraphing.Setup, false);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQXNzYXlUYWJsZURhdGFHcmFwaGluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkFzc2F5VGFibGVEYXRhR3JhcGhpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEscURBQXFEO0FBRXJELElBQUksY0FBa0IsQ0FBQztBQUV2QixjQUFjLEdBQUc7SUFFaEIsUUFBUSxFQUFDLElBQUk7SUFDYixVQUFVLEVBQUMsSUFBSTtJQUVaLFFBQVEsRUFBQyxFQUFFO0lBQ1gsU0FBUyxFQUFDLEVBQUU7SUFFZixhQUFhLEVBQUMsSUFBSTtJQUNsQixtQkFBbUIsRUFBQyxJQUFJO0lBRXhCLFdBQVcsRUFBQyxFQUFFO0lBRWQsWUFBWSxFQUFDO1FBQ1osTUFBTSxFQUFFO1lBQ1AsS0FBSyxFQUFFO2dCQUNWLGtCQUFrQjtnQkFDZCxJQUFJLEVBQUUsSUFBSTthQUNWO1lBQ0QsTUFBTSxFQUFFO2dCQUNQLElBQUksRUFBRSxJQUFJO2dCQUNWLE1BQU0sRUFBRSxHQUFHO2FBQ1g7WUFDRCxVQUFVLEVBQUUsQ0FBQztTQUNiO1FBQ0QsSUFBSSxFQUFFO1lBQ0wsU0FBUyxFQUFFLElBQUk7WUFDZixTQUFTLEVBQUUsSUFBSTtZQUNmLGFBQWEsRUFBRSxJQUFJO1lBQ25CLGVBQWUsRUFBRSxNQUFNO1lBQ3ZCLFdBQVcsRUFBRSxNQUFNO1NBQ25CO1FBQ0QsU0FBUyxFQUFFO1lBQ1YsSUFBSSxFQUFFLEdBQUc7U0FDVDtRQUNELEtBQUssRUFBRSxFQUNOO1FBQ0QsS0FBSyxFQUFFO1lBQ04sU0FBUyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNqQjtRQUNELElBQUksRUFBRTtZQUNMLFdBQVcsRUFBRSxLQUFLO1NBQ2xCO1FBQ0QsR0FBRyxFQUFFO1lBQ0osV0FBVyxFQUFFLEtBQUs7U0FDbEI7UUFDRCxNQUFNLEVBQUU7WUFDUCxJQUFJLEVBQUUsS0FBSztTQUNYO0tBQ0Q7SUFHRCxLQUFLLEVBQUM7UUFFTCxjQUFjLENBQUMsUUFBUSxH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QUUsQ0FBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFDLEdBQUcsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFDLEdBQUcsRUFBQyxDQUFDLENBQUM7WUFDN0UsQ0FBQyxHQUFHLEVBQUMsR0FBRyxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFDLEVBQUUsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUMsRUFBRSxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFDLEVBQUUsRUFBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBQyxFQUFFLEVBQUMsR0FBRyxDQUFDO1lBQzlFLENBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBQyxFQUFFLEVBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUMsRUFBRSxFQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFDLEVBQUUsRUFBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUMsR0FBRyxFQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFaEYsa0NBQWtDO1FBQ2xDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQztRQUFDLENBQUM7UUFFN0IseUNBQXlDO1FBQ3pDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQztRQUFDLENBQUM7UUFFN0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDWCxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtRQUN0QyxDQUFDO1FBRUQsSUFBSSxhQUFhLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3RELElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDdkMsSUFBSSxTQUFTLEdBQUcsYUFBYSxHQUFHLE1BQU0sQ0FBQztRQUN2QyxJQUFJLE1BQU0sR0FBRyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ3hCLElBQUksU0FBUyxHQUFHLE1BQU0sR0FBRyxhQUFhLENBQUM7UUFDekMsMEVBQTBFO1FBQ3hFLElBQUksQ0FBQyxHQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUNsRyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDOUYsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBRTlGLE1BQU0sQ0FBQyxNQUFNLEdB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cEMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNoQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ3RCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3RDLElBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDbEQsRUFBRSxDQUFDLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7d0JBQ25CLE1BQU0sQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO29CQUMzQixDQUFDO2dCQUNGLENBQUM7WUFDRixDQUFDO1FBQ0ksQ0FBQztJQUNMLENBQUM7Q0FDSixDQUFDO0FBR0YsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cInR5cGVzY3JpcHQtZGVjbGFyYXRpb25zLmQudHNcIiAvPlxuXG52YXIgRUREQVRER3JhcGhpbmc6YW55O1xuXG5FRERBVERHcmFwaGluZyA9IHtcblxuXHRncmFwaERpdjpudWxsLFxuXHRwbG90T2JqZWN0Om51bGwsXG5cbiAgICBkYXRhU2V0czpbXSxcbiAgICB0aWNrQXJyYXk6W10sXG5cblx0cHJldmlvdXNQb2ludDpudWxsLFxuXHRwcmV2aW91c1BvaW50U2VyaWVzOm51bGwsXG5cblx0c2V0c0ZldGNoZWQ6e30sXG5cblx0Z3JhcGhPcHRpb25zOntcblx0XHRzZXJpZXM6IHtcblx0XHRcdGxpbmVzOiB7XG4vL1x0XHRcdFx0c3RlcHM6IHRydWUsXG5cdFx0XHRcdHNob3c6IHRydWVcblx0XHRcdH0sXG5cdFx0XHRwb2ludHM6IHtcblx0XHRcdFx0c2hvdzogdHJ1ZSxcblx0XHRcdFx0cmFkaXVzOiAxLjUsXG5cdFx0XHR9LFxuXHRcdFx0c2hhZG93U2l6ZTogMFxuXHRcdH0sXG5cdFx0Z3JpZDoge1xuXHRcdFx0aG92ZXJhYmxlOiB0cnVlLFxuXHRcdFx0Y2xpY2thYmxlOiB0cnVlLFxuXHRcdFx0YXV0b0hpZ2hsaWdodDogdHJ1ZSxcblx0XHRcdGJhY2tncm91bmRDb2xvcjogXCIjRkZGXCIsXG5cdFx0XHRib3JkZXJDb2xvcjogXCIjRUVFXCJcblx0XHR9LFxuXHRcdGNyb3NzaGFpcjoge1xuXHRcdFx0bW9kZTogXCJ4XCJcblx0XHR9LFxuXHRcdHhheGlzOiB7XG5cdFx0fSxcblx0XHR5YXhpczoge1xuXHRcdFx0em9vbVJhbmdlOiBbMSwgMV1cblx0XHR9LFxuXHRcdHpvb206IHtcblx0XHRcdGludGVyYWN0aXZlOiBmYWxzZVxuXHRcdH0sXG5cdFx0cGFuOiB7XG5cdFx0XHRpbnRlcmFjdGl2ZTogZmFsc2Vcblx0XHR9LFxuXHRcdGxlZ2VuZDoge1xuXHRcdFx0c2hvdzogZmFsc2Vcblx0XHR9XG5cdH0sXG5cblxuXHRTZXR1cDpmdW5jdGlvbigpIHtcblxuXHRcdEVEREFUREdyYXBoaW5nLmdyYXBoRGl2ID0gJChcIiNncmFwaERpdlwiKTtcblx0XG5cdFx0RUREQVRER3JhcGhpbmcuZ3JhcGhEaXYuYmluZChcInBsb3Rob3ZlclwiLCBFRERBVERHcmFwaGluZy5ob3ZlckZ1bmN0aW9uKTtcblx0XHRFRERBVERHcmFwaGluZy5ncmFwaERpdi5iaW5kKFwicGxvdGNsaWNrXCIsIEVEREFUREdyYXBoaW5nLnBsb3RDbGlja0Z1bmN0aW9uKTtcblx0XHRFRERBVERHcmFwaGluZy5ncmFwaE9wdGlvbnMueGF4aXMudGlja3MgPSBFRERBVERHcmFwaGluZy50aWNrR2VuZXJhdG9yRnVuY3Rpb247XG5cblx0XHRFRERBVERHcmFwaGluZy5wbG90T2JqZWN0ID0gJC5wbG90KEVEREFUREdyYXBoaW5nLmdyYXBoRGl2LCBFRERBVERHcmFwaGluZy5kYXRhU2V0cywgRUREQVRER3JhcGhpbmcuZ3JhcGhPcHRpb25zKTtcdFxuXHR9LFxuXG5cblx0Y2xlYXJBbGxTZXRzOmZ1bmN0aW9uKCkge1xuXG5cdFx0RUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWQgPSB7fTtcblx0fSxcblx0XG5cblx0YWRkTmV3U2V0OmZ1bmN0aW9uKG5ld1NldCkge1xuXG5cdFx0aWYgKCFuZXdTZXQubGFiZWwpIHtcblx0XHRcdCQoJyNkZWJ1ZycpLnRleHQoJ0ZhaWxlZCB0byBmZXRjaCBzZXJpZXMuJyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0RUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWRbbmV3U2V0LmxhYmVsXSA9IG5ld1NldDtcblxuLy9cdFx0RUREQVRER3JhcGhpbmcucmVhc3NpZ25HcmFwaENvbG9ycygpO1xuLy9cdFx0RUREQVRER3JhcGhpbmcucmVkcmF3R3JhcGgoKTtcblx0fSxcblxuXG5cdGRyYXdTZXRzOmZ1bmN0aW9uKCkge1xuXHRcdEVEREFUREdyYXBoaW5nLnJlYXNzaWduR3JhcGhDb2xvcnMoKTtcblx0XHRFRERBVERHcmFwaGluZy5yZWRyYXdHcmFwaCgpO1xuXHR9LFxuXG5cblx0cmVhc3NpZ25HcmFwaENvbG9yczpmdW5jdGlvbigpIHtcblx0XHR2YXIgc2V0Q291bnQgPSAwO1x0Ly8gRGFtbiwgdGhlcmUgaGFzIHRvIGJlIGEgYmV0dGVyIHdheSB0byBkbyB0aGlzLlxuXHRcdHZhciBhY3RpdmVTZXRDb3VudCA9IDA7XG5cdFx0Zm9yICh2YXIgaSBpbiBFRERBVERHcmFwaGluZy5zZXRzRmV0Y2hlZCkge1xuXHRcdFx0c2V0Q291bnQrKztcblx0XHRcdHZhciBvbmVTZXQgPSBFRERBVERHcmFwaGluZy5zZXRzRmV0Y2hlZFtpXTtcblx0XHRcdGlmIChvbmVTZXQuZGF0YSkge1xuXHRcdFx0XHRhY3RpdmVTZXRDb3VudCsrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHZhciBzZXRJbmRleCA9IDA7XG5cdFx0Zm9yICh2YXIgaSBpbiBFRERBVERHcmFwaGluZy5zZXRzRmV0Y2hlZCkge1xuXHRcdFx0dmFyIG9uZVNldCA9IEVEREFUREdyYXBoaW5nLnNldHNGZXRjaGVkW2ldO1xuXHRcdFx0aWYgKG9uZVNldC5kYXRhKSB7XG5cdFx0XHRcdG9uZVNldC5jb2xvciA9IEVEREFUREdyYXBoaW5nLmludEFuZFJhbmdlVG9MaW5lQ29sb3Ioc2V0SW5kZXgsIGFjdGl2ZVNldENvdW50KTtcblxuXHRcdFx0XHR2YXIgdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvbmVTZXQubGFiZWwgKyAnTGFiZWwnKTtcblx0XHRcdFx0aWYgKHRzKSB7XG5cdFx0XHRcdFx0dHMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gb25lU2V0LmNvbG9yO1xuXHRcdFx0XHQgICAgdHMuc3R5bGUuY29sb3IgPSAnI0ZGRic7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHNldEluZGV4Kys7XG5cdFx0fVxuXHR9LFxuXG5cblx0aW50QW5kUmFuZ2VUb0xpbmVDb2xvcjpmdW5jdGlvbihpLHIpIHtcblx0XHQvLyAxNyBpbnRlcm1lZGlhdGUgc3BvdHMgb24gdGhlIGNvbG9yIHdoZWVsLCBhZGp1c3RlZCBmb3IgdmlzaWJpbGl0eSxcblx0XHQvLyB3aXRoIHRoZSAxOHRoIGEgY2xvbmUgb2YgdGhlIDFzdC5cblx0XHR2YXIgbGluZUNvbG9ycyA9IFtcblx0XHRcdFswLDEzNiwxMzJdLCBbMTAsMTM2LDEwOV0sIFsxMywxNDMsNDVdLCBbMjAsMTM2LDEwXSwgWzcyLDEzNiwxMF0sIFsxMjUsMTM2LDBdLFxuXHRcdFx0WzEzNiwxMDgsMTBdLCBbMTM2LDczLDExXSwgWzEzNiw0MywxNF0sIFsxMzYsMTQsNDNdLCBbMTM2LDExLDg4XSwgWzExOCwxMywxMzZdLFxuXHRcdFx0Wzg5LDIzLDEzNl0sIFs0MywyMCwxMzZdLCBbMTQsMjMsMTM2XSwgWzEyLDQ0LDEzNl0sIFsxMywxMDcsMTM2XSwgWzAsMTM2LDEzMl1dO1xuXG5cdFx0Ly8gUmFuZ2Ugb2YgMCBpcyBqdXN0IHVuYWNjZXB0YWJsZVxuXHRcdGlmIChyIDwgMSkgeyByZXR1cm4gJyM4ODgnOyB9XG5cblx0XHQvLyBOZWdhdGl2ZSBpbmRleCBpcyBlcXVhbGx5IHVuYWNjZXB0YWJsZVxuXHRcdGlmIChpIDwgMCkgeyByZXR1cm4gJyM4ODgnOyB9XG5cblx0XHRpZiAoaSA+IHIpIHtcblx0XHRcdGkgPSBpICUgcjtcdC8vIE1ha2Ugc3VyZSBpIGlzIHdpdGhpbiByXG5cdFx0fVxuXG5cdFx0dmFyIGFkanVzdGVkUmFuZ2UgPSAoaSAvIHIpICogKGxpbmVDb2xvcnMubGVuZ3RoIC0gMik7XG5cdFx0dmFyIGxJbmRleCA9IE1hdGguZmxvb3IoYWRqdXN0ZWRSYW5nZSk7XG5cdFx0dmFyIGxmcmFjdGlvbiA9IGFkanVzdGVkUmFuZ2UgLSBsSW5kZXg7XG5cdFx0dmFyIHJJbmRleCA9IGxJbmRleCArIDE7XG5cdFx0dmFyIHJmcmFjdGlvbiA9IHJJbmRleCAtIGFkanVzdGVkUmFuZ2U7XG4vL1x0XHRjb25zb2xlLmxvZyhySW5kZXggKyAnICcgKyBsZnJhY3Rpb24gKyAnICcgKyAobGluZUNvbG9ycy5sZW5ndGggLSAyKSk7XG5cdFx0dmFyIHI6YW55ID0gTWF0aC5mbG9vcigobGluZUNvbG9yc1tsSW5kZXhdWzBdICogbGZyYWN0aW9uKSArIChsaW5lQ29sb3JzW3JJbmRleF1bMF0gKiByZnJhY3Rpb24pKTtcblx0XHR2YXIgZyA9IE1hdGguZmxvb3IoKGxpbmVDb2xvcnNbbEluZGV4XVsxXSAqIGxmcmFjdGlvbikgKyAobGluZUNvbG9yc1tySW5kZXhdWzFdICogcmZyYWN0aW9uKSk7XG5cdFx0dmFyIGIgPSBNYXRoLmZsb29yKChsaW5lQ29sb3JzW2xJbmRleF1bMl0gKiBsZnJhY3Rpb24pICsgKGxpbmVDb2xvcnNbckluZGV4XVsyXSAqIHJmcmFjdGlvbikpO1xuXHRcdFxuXHRcdHJldHVybiAncmdiKCcgKyByICsgJywgJyArIGcgKyAnLCAnICsgYiArICcpJztcblx0fSxcblxuXG5cdHJlZHJhd0dyYXBoOmZ1bmN0aW9uKCkge1xuXHRcdEVEREFUREdyYXBoaW5nLmRhdGFTZXRzID0gW107XG5cblx0XHRmb3IgKHZhciBvbmVTZXQgaW4gRUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWQpIHtcblx0ICAgXHRcdEVEREFUREdyYXBoaW5nLmRhdGFTZXRzLnB1c2goRUREQVRER3JhcGhpbmcuc2V0c0ZldGNoZWRbb25lU2V0XSk7XG5cdFx0fVxuXG5cdFx0RUREQVRER3JhcGhpbmcucmVidWlsZFhBeGlzKCk7XG5cblx0XHRFRERBVERHcmFwaGluZy5wbG90T2JqZWN0ID0gJC5wbG90KEVEREFUREdyYXBoaW5nLmdyYXBoRGl2LCBFRERBVERHcmFwaGluZy5kYXRhU2V0cywgRUREQVRER3JhcGhpbmcuZ3JhcGhPcHRpb25zKTtcblx0fSxcblxuXG5cdHJlYnVpbGRYQXhpczpmdW5jdGlvbigpIHtcblx0XG5cdFx0RUREQVRER3JhcGhpbmcudGlja0FycmF5ID0gW107XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IEVEREFUREdyYXBoaW5nLmRhdGFTZXRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgb25lU2VyaWVzID0gRUREQVRER3JhcGhpbmcuZGF0YVNldHNbaV07XG5cblx0XHRcdGlmIChvbmVTZXJpZXMuZGF0YSkge1xuXHRcdFx0XHR2YXIgZGkgPSAwO1xuXHRcdFx0XHR2YXIgdGkgPSAwO1xuXHRcdFx0XHR2YXIgb2xkVGlja0FycmF5ID0gRUREQVRER3JhcGhpbmcudGlja0FycmF5O1xuXHRcdFx0XHRFRERBVERHcmFwaGluZy50aWNrQXJyYXkgPSBbXTtcblxuXHRcdFx0XHR3aGlsZSAoKGRpIDwgb25lU2VyaWVzLmRhdGEubGVuZ3RoKSAmJiAodGkgPCBvbGRUaWNrQXJyYXkubGVuZ3RoKSkge1xuXHRcdFx0XHRcdHZhciBkID0gcGFyc2VGbG9hdChvbmVTZXJpZXMuZGF0YVtkaV1bMF0pO1xuXHRcdFx0XHRcdHZhciB0ID0gb2xkVGlja0FycmF5W3RpXVswXTtcblx0XHRcdFx0XHRpZiAoZCA9PSB0KSB7XG5cdFx0XHRcdFx0XHRFRERBVERHcmFwaGluZy50aWNrQXJyYXkucHVzaChbdCwgb2xkVGlja0FycmF5W3RpXVsxXV0pO1xuXHRcdFx0XHRcdFx0ZGkrKztcblx0XHRcdFx0XHRcdHRpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChkIDwgdCkge1xuXHRcdFx0XHRcdFx0RUREQVRER3JhcGhpbmcudGlja0FycmF5LnB1c2goW2QsIGRdKTtcblx0XHRcdFx0XHRcdGRpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICh0IDwgZCkge1xuXHRcdFx0XHRcdFx0RUREQVRER3JhcGhpbmcudGlja0FycmF5LnB1c2goW3QsIG9sZFRpY2tBcnJheVt0aV1bMV1dKTtcblx0XHRcdFx0XHRcdHRpKys7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHdoaWxlIChkaSA8IG9uZVNlcmllcy5kYXRhLmxlbmd0aCkge1xuXHRcdFx0XHRcdHZhciBkID0gcGFyc2VGbG9hdChvbmVTZXJpZXMuZGF0YVtkaV1bMF0pO1xuXHRcdFx0XHRcdEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5wdXNoKFtkLCBkXSk7XG5cdFx0XHRcdFx0ZGkrKztcblx0XHRcdFx0fVxuXHRcdFx0XHR3aGlsZSAodGkgPCBvbGRUaWNrQXJyYXkubGVuZ3RoKSB7XG5cdFx0XHRcdFx0dmFyIHQgPSBvbGRUaWNrQXJyYXlbdGldWzBdO1xuXHRcdFx0XHRcdEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5wdXNoKFt0LCBvbGRUaWNrQXJyYXlbdGldWzFdXSk7XG5cdFx0XHRcdFx0dGkrKztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcdFxuXG5cblx0dGlja0dlbmVyYXRvckZ1bmN0aW9uOmZ1bmN0aW9uKGF4aXMpIHtcblx0ICAgIHZhciByZXMgPSBbXTtcblx0ICAgIGlmICghRUREQVRER3JhcGhpbmcuZ3JhcGhEaXYpIHtcblx0ICAgIFx0cmV0dXJuIHJlcztcblx0ICAgIH1cblx0ICAgIHZhciBncmFwaERpdldpZHRoID0gRUREQVRER3JhcGhpbmcuZ3JhcGhEaXYud2lkdGgoKTtcblx0ICAgIGlmICghZ3JhcGhEaXZXaWR0aCkge1xuXHQgICAgXHRyZXR1cm4gcmVzO1xuXHQgICAgfVxuXG5cdFx0dmFyIHBvcnRTaXplID0gYXhpcy5tYXggLSBheGlzLm1pbjtcblx0XHRpZiAocG9ydFNpemUgPCAxKSB7XG5cdFx0XHRyZXR1cm4gcmVzO1xuXHRcdH1cblxuXHRcdC8vIEhlbSB0aGUgcmVnaW9uIGluIG9uIHRoZSByaWdodCBzaWRlIHRvIHByZXZlbnQgdGhlIGRpdnMgZnJvbSBkcmF3aW5nIG9mZnNjcmVlblxuXHRcdC8vIGFuZCBzdW1tb25pbmcgYSBob3Jpem9udGFsIHNjcm9sbGJhci5cblx0XHR2YXIgbWF4RWRnZSA9IE1hdGguZmxvb3IoYXhpcy5tYXggLSAoKHBvcnRTaXplIC8gZ3JhcGhEaXZXaWR0aCkgKiAyMCkpO1xuXHRcdGlmIChtYXhFZGdlIDw9IGF4aXMubWluKSB7XG5cdFx0XHRyZXR1cm4gcmVzO1xuXHRcdH1cblxuLy9cdFx0Y29uc29sZS5sb2coXCJheGlzLm1heDogXCIgKyBheGlzLm1heCArIFwiIGF4aXMubWluOiBcIiArIGF4aXMubWluICtcbi8vXHRcdFx0XCIgcG9ydFNpemU6IFwiICsgcG9ydFNpemUgKyBcIiBncmFwaERpdldpZHRoOiBcIiArIGdyYXBoRGl2V2lkdGggK1xuLy9cdFx0XHRcIiBNYXhlZGdlOiBcIiArIG1heEVkZ2UpO1xuXG5cdFx0Ly8gMjYgcGl4ZWxzIGlzIGFib3V0IGhvdyBtdWNoIHNjcmVlbiB3aWR0aCB3ZSBuZWVkIGZvciBlYWNoIGxhYmVsLlxuXHRcdC8vIFRoZSB2YXJpYWJsZSBzdGVwU2l6ZSBpcyB0aGUgbWluaW11bSBkaXN0YW5jZSBhbG9uZyB0aGUgeCBheGlzXG5cdFx0Ly8gd2UgbXVzdCBzdGVwIHRvIGtlZXAgdGhlIGxhYmVscyBmcm9tIG92ZXJsYXBwaW5nLlxuXHRcdHZhciBzdGVwU2l6ZSA9IE1hdGguZmxvb3IoKHBvcnRTaXplIC8gZ3JhcGhEaXZXaWR0aCkgKiAyNik7XG5cdFx0aWYgKCFFRERBVERHcmFwaGluZy50aWNrQXJyYXkpIHtcblx0XHRcdHJldHVybiByZXM7XG5cdFx0fVxuXHRcdGlmIChzdGVwU2l6ZSA8IDEpIHsgLy8gU3RlcCBzaXplIG9mIGxlc3MgdGhhbiBvbmUgd291bGQgbm90IGFkdmFuY2UgdGhyb3VnaCB0aGUgYXJyYXkgYXQgYWxsIVxuXHRcdFx0c3RlcFNpemUgPSAxO1xuXHRcdH1cblx0XHQvLyBsYXJnZXN0U2NhbGUgaXMgdGhlIG51bWJlciBvZiB0aWNrcyBvbiB0aGUgYXhpcyB3ZSBoYXZlIHRvIGNob29zZSBmcm9tXG5cdFx0dmFyIGxhcmdlc3RTY2FsZSA9IEVEREFUREdyYXBoaW5nLnRpY2tBcnJheS5sZW5ndGg7XG5cdFx0aWYgKGxhcmdlc3RTY2FsZSA8IDEpIHtcblx0XHRcdHJldHVybiByZXM7XG5cdFx0fVxuXG4vL1x0XHRjb25zb2xlLmxvZyhcInN0ZXBTaXplOiBcIiArIHN0ZXBTaXplICsgXCIgbGFyZ2VzdFNjYWxlOiBcIiArIGxhcmdlc3RTY2FsZSk7XG5cblx0XHQvLyBUaGlzIGNvZGUgcGVyZm9ybXMgYSBiaW5hcnkgc2VhcmNoIGRvd24gaW50byB0aGUgYXJyYXksXG5cdFx0Ly8gaHVudGluZyBmb3IgdGhlIGNsb3Nlc3QgbWF0Y2ggdG8gdGhlIGdpdmVuIHZhbHVlXG5cdFx0Ly8gKHRoZSBsZWZ0IGVkZ2Ugb2YgdGhlIHJlZ2lvbiB3ZSBhcmUgdHJ5aW5nIHRvIHBsYWNlIGEgdGljayBpbilcblxuXHRcdHZhciB3aW5kb3dMZWZ0V2F2ZSA9IGF4aXMubWluO1xuXHRcdHZhciBwcmV2SSA9IC0xO1xuXG5cdFx0Ly8gSGludDogSWYgdGhpcyBnaXZlcyBiaXphcnJlIHJlc3VsdHMsIG1ha2Ugc3VyZSB5b3UgaGF2ZSBldmVyeXRoaW5nXG5cdFx0Ly8gY2FzdGVkIHRvIGZsb2F0cyBvciBpbnRzLCBpbnN0ZWFkIG9mIHN0cmluZ3MuXG5cblx0XHRkbyB7XG5cblx0XHRcdHZhciBzU2NhbGUgPSBsYXJnZXN0U2NhbGUgLyAyO1xuXHRcdFx0dmFyIGkgPSBzU2NhbGU7XG5cdFx0XHRkbyB7XG5cdFx0XHRcdHZhciB2ID0gRUREQVRER3JhcGhpbmcudGlja0FycmF5W01hdGguZmxvb3IoaSldWzBdO1xuXHRcdFx0XHRzU2NhbGUgPSBzU2NhbGUgLyAyO1xuXHRcdFx0XHRpZiAodiA+IHdpbmRvd0xlZnRXYXZlKSB7XG5cdFx0XHRcdFx0aSA9IGkgLSBzU2NhbGU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aSA9IGkgKyBzU2NhbGU7XG5cdFx0XHRcdH1cbi8vXHRcdFx0XHRjb25zb2xlLmxvZyhcInY6IFwiICsgdiArIFwiIGk6IFwiICsgaSArIFwiIHNTY2FsZTogXCIgKyBzU2NhbGUpO1x0XHRcdFx0XG5cdFx0XHR9IHdoaWxlIChzU2NhbGUgPiAwLjQpO1xuXG5cdFx0XHQvLyBUaGUgaW5kZXggaXMgbWVhbnQgdG8gZW5kIHVwIHBvaW50aW5nIGJldHdlZW4gdGhlIHR3byB2YWx1ZXMgb24gZWl0aGVyIHNpZGVcblx0XHRcdC8vIG9mIG91ciB0YXJnZXQsIGJ1dCBtYXkgYmUgb2ZmIGJ5IG9uZSB2YWx1ZSB3aGVuIHdlIHF1aXQgc2VhcmNoaW5nIGR1ZSB0byBhXG5cdFx0XHQvLyByb3VuZGluZyBpc3N1ZS4gIFNvIHdlIHRha2UgdGhlIGZsb29yIGFuZCB0ZXN0IHRoYXQgdmFsdWUsIGFuZCBjaG9vc2UgdGhlIG9uZVxuXHRcdFx0Ly8ganVzdCBoaWdoZXIgaWYgaXQncyB0b28gbG93LlxuXHRcdFx0aSA9IE1hdGguZmxvb3IoaSk7XG5cdFx0XHRpZiAoRUREQVRER3JhcGhpbmcudGlja0FycmF5W2ldWzBdIDwgd2luZG93TGVmdFdhdmUpIHtcblx0XHRcdFx0aSA9IGkgKyAxO1xuXHRcdFx0fVxuXHRcblx0XHRcdC8vIElmLCBieSBzZWVraW5nIHRoZSBoaWdoZXIgdmFsdWUsIHdlIGVuZCB1cCBvZmYgdGhlIGVuZCBvZiB0aGUgYXJyYXksIHRoZW5cblx0XHRcdC8vIHRoZXJlIGFyZSBubyBtb3JlIHZhbHVlcyB3ZSBjYW4gYWRkLlxuXHRcdFx0aWYgKGkgPj0gRUREQVRER3JhcGhpbmcudGlja0FycmF5Lmxlbmd0aCkge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0cmVzLnB1c2goW0VEREFUREdyYXBoaW5nLnRpY2tBcnJheVtpXVswXSwgRUREQVRER3JhcGhpbmcudGlja0FycmF5W2ldWzFdXSk7XG5cdFxuXHRcdFx0Ly8gVGFrZSB0aGUgbG9jYXRpb24gb2YgdGhpcyB0aWNrLCBwbHVzIG91ciBzY2FsZWQgc3BhY2VyLCBhbmQgdXNlIHRoYXQgYXMgdGhlXG5cdFx0XHQvLyBuZXcgbGVmdCBlZGdlIG9mIG91ciB0aWNrIHNlYXJjaC5cblx0XHRcdHdpbmRvd0xlZnRXYXZlID0gRUREQVRER3JhcGhpbmcudGlja0FycmF5W2ldWzBdICsgc3RlcFNpemU7XG5cblx0XHRcdC8vIElmLCBmb3IgYW55IHJlYXNvbiwgd2UgZW5kIHVwIG9uIHRoZSBzYW1lIGluZGV4IHR3aWNlIGluIGEgcm93LFxuXHRcdFx0Ly8gYmFpbCBvdXQgdG8gcHJldmVudCBhbiBpbmZpbml0ZSBsb29wLlxuXHRcdFx0aWYgKGkgPT0gcHJldkkpIHtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cblx0XHRcdHByZXZJID0gaTtcblxuXHRcdH0gd2hpbGUgKHdpbmRvd0xlZnRXYXZlIDwgbWF4RWRnZSk7XG5cblx0XHRyZXR1cm4gcmVzO1xuXHR9LFxuXHRcbiAgICBcbiAgICBob3ZlckZ1bmN0aW9uOmZ1bmN0aW9uKGV2ZW50LCBwb3MsIGl0ZW0pIHtcblx0XHRpZiAoaXRlbSkge1xuXHRcdFx0aWYgKChFRERBVERHcmFwaGluZy5wcmV2aW91c1BvaW50ICE9IGl0ZW0uZGF0YUluZGV4KSB8fFxuXHRcdFx0XHQoRUREQVRER3JhcGhpbmcucHJldmlvdXNQb2ludFNlcmllcyAhPSBpdGVtLnNlcmllcy5uYW1lKSkge1xuXHRcdFx0XHRFRERBVERHcmFwaGluZy5wcmV2aW91c1BvaW50ID0gaXRlbS5kYXRhSW5kZXg7XG5cdFx0XHRcdEVEREFUREdyYXBoaW5nLnByZXZpb3VzUG9pbnRTZXJpZXMgPSBpdGVtLnNlcmllcy5uYW1lO1xuXG5cdFx0XHRcdCQoXCIjdG9vbHRpcFwiKS5yZW1vdmUoKTtcblx0XHRcdFx0dmFyIHggPSBpdGVtLmRhdGFwb2ludFswXS50b0ZpeGVkKDIpLFxuXHRcdFx0XHRcdHkgPSBpdGVtLmRhdGFwb2ludFsxXS50b0ZpeGVkKDIpO1xuXHRcdFx0XHR2YXIgdGVtcGNvbmZpZyA9ICcnO1xuXHRcdFx0XHRpZiAoaXRlbS5zZXJpZXMubmFtZSkge1xuXHRcdFx0XHRcdHRlbXBjb25maWcgPSBpdGVtLnNlcmllcy5uYW1lICsgJzo8YnI+Jztcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgdGVtcHVuaXRzID0gJyc7XG5cdFx0XHRcdGlmIChpdGVtLnNlcmllcy51bml0cykge1xuXHRcdFx0XHRcdHRlbXB1bml0cyA9IGl0ZW0uc2VyaWVzLnVuaXRzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHZhciB0ZW1wbGFiZWwgPSB0ZW1wY29uZmlnICsgJzxCPicgKyB5ICsgJzwvQj4gJyArIHRlbXB1bml0cztcblx0XHRcdFx0dmFyIHRlbXB0YWcgPSAnJztcblx0XHRcdFx0aWYgKGl0ZW0uc2VyaWVzLnRhZ3MpIHtcblx0XHRcdFx0XHRpZiAoaXRlbS5zZXJpZXMudGFnc1tpdGVtLmRhdGFJbmRleF0pIHtcblx0XHRcdFx0XHRcdHRlbXB0YWcgPSBpdGVtLnNlcmllcy50YWdzW2l0ZW0uZGF0YUluZGV4XVsxXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRlbXB0YWcgIT0gJycpIHtcblx0XHRcdFx0XHR0ZW1wbGFiZWwgPSB0ZW1wbGFiZWwgKyAnPGJyPicgKyB0ZW1wdGFnO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHRFRERBVERHcmFwaGluZy5zaG93VG9vbHRpcChpdGVtLnBhZ2VYICsgNSwgaXRlbS5wYWdlWSArIDUsIHRlbXBsYWJlbCwgaXRlbS5zZXJpZXMuY29sb3IpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKFwiI3Rvb2x0aXBcIikucmVtb3ZlKCk7XG5cdFx0XHRFRERBVERHcmFwaGluZy5wcmV2aW91c1BvaW50ID0gbnVsbDsgICAgICAgICAgICBcblx0XHRcdEVEREFUREdyYXBoaW5nLnByZXZpb3VzUG9pbnRTZXJpZXMgPSBudWxsOyAgICAgICAgICAgIFxuXHRcdH1cbiAgICB9LFxuXG5cbiAgICBzaG93VG9vbHRpcDpmdW5jdGlvbih4LCB5LCBjb250ZW50cywgY29sKSB7XG4gICAgICAgIHZhciBuZXdUaXA6YW55ID0gJCgnPGRpdiBpZD1cInRvb2x0aXBcIiBjbGFzcz1cImdyYXBoVG9vbFRpcFwiPicgKyBjb250ZW50cyArICc8L2Rpdj4nKTtcblxuXHRcdC8vIFdlIHdpbGwgcGxhY2UgdGhlIHRvb2x0aXAgaW4gdGhlIGxvY2F0aW9uIHNwZWNpZmllZCwgdW5sZXNzXG5cdFx0Ly8gdGhlIHJlbmRlcmVkIHdpZHRoIG9mIHRoZSBjb250ZW50IHJ1bnMgb2ZmIHJpZ2h0IGVkZ2UsXG5cdFx0Ly8gaW4gd2hpY2ggY2FzZSB3ZSB3aWxsIHNoaWZ0IGl0IGxlZnQgdG8gYmUgZmx1c2ggd2l0aCB0aGUgcmlnaHQtZWRnZSBvZiB0aGUgd2luZG93LFxuXHRcdC8vIGFuZCByZS13cml0ZSB0aGUgd2lkdGggb2YgdGhlIGJveCBzbyBpdCBjb25mb3JtcyB0byB0aGUgd3JhcHBpbmcgb2YgdGhlIHRleHQuXG5cbiAgICAgICAgbmV3VGlwLmNzcygge1xuICAgICAgICAgICAgdG9wOiB5LFxuICAgICAgICAgICAgbGVmdDogeFxuICAgICAgICB9KTtcblxuXHRcdGlmIChjb2wpIHtcblx0ICAgICAgICBuZXdUaXAuY3NzKCB7ICdjb2xvcic6IGNvbCB9KTtcblx0XHR9XG5cblx0XHRuZXdUaXAuYXBwZW5kVG8oXCJib2R5XCIpO1xuXG5cdFx0bmV3VGlwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0b29sdGlwXCIpO1xuXHRcdHZhciBuZXdUaXBXaWR0aCA9IG5ld1RpcC5jbGllbnRXaWR0aDtcblxuXHRcdGlmICgoeCArIG5ld1RpcFdpZHRoICsgMjApID4gd2luZG93LmlubmVyV2lkdGgpIHtcblx0XHRcdC8vIHRvb2x0aXAgb24gbGVmdCBoYW5kIHNpZGUsIG5hc3R5IGhhY2sgdG8gc2hpZnQgdGhlIGxhYmVsXG5cdFx0XHRuZXdUaXAuc3R5bGUud2lkdGggPSAobmV3VGlwV2lkdGgrMikgKyBcInB4XCI7XG5cdFx0XHRuZXdUaXAuc3R5bGUubGVmdCA9ICh4IC0gbmV3VGlwV2lkdGgpICsgXCJweFwiO1xuXHRcdH1cbiAgICB9LFxuXG5cblx0cGxvdENsaWNrRnVuY3Rpb246ZnVuY3Rpb24oZXZlbnQsIHBvcywgaXRlbSkge1xuICAgICAgICBpZiAoaXRlbSkge1xuXHRcdFx0aWYgKGl0ZW0uc2VyaWVzLnVybHMpIHtcblx0XHRcdFx0aWYgKGl0ZW0uc2VyaWVzLnVybHNbaXRlbS5kYXRhSW5kZXhdKSB7XG5cdFx0XHRcdFx0dmFyIHRlbXB1cmwgPSBpdGVtLnNlcmllcy51cmxzW2l0ZW0uZGF0YUluZGV4XVsxXTtcblx0XHRcdFx0XHRpZiAodGVtcHVybCAhPSAnJykge1xuXHRcdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uID0gdGVtcHVybDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBFRERBVERHcmFwaGluZy5TZXR1cCwgZmFsc2UpOyJdfQ==