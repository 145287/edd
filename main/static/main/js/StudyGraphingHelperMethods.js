// File last modified on: Wed Dec 21 2016 14:53:35  
/// <reference path="../typings/d3/d3.d.ts"/>;
var StudyHelper;
StudyHelper = {
    /** this function takes in element and returns an array of selectors
     * [<div id=​"linechart">​</div>​, <div id=​"timeBar">​</div>​, <div id=​"single">​</div>​,
     * <div id=​"barAssay">​</div>​]
     */
    getButtonElement: function (element) {
        return $(element.siblings(':first')).find("label");
    },
    /**
     * this function takes in the graphDiv element and returns an array of 4 buttons
     */
    getSelectorElement: function (element) {
        if ($(element).attr('id') != 'maingraph') {
            var selector = element.siblings().eq(1);
            return $(selector).children();
        }
        else {
            return element.siblings().addBack();
        }
    },
    /** this function takes in an element  selector and an array of svg rects and returns
     * returns message or nothing.
     */
    svgWidth: function (selector, rectArray) {
        $('.tooMuchData').hide();
        $('.noData').hide();
        var sum = 0;
        _.each(rectArray, function (rectElem) {
            if (rectElem.getAttribute("width") != 0) {
                sum++;
            }
        });
        if (sum === 0) {
            $(selector).prepend("<p class=' tooMuchData'>Too many data points to display" +
                "</p><p  class=' tooMuchData'>Recommend filtering by protocol</p>");
        }
    },
    /** this function takes in the EDDData.MeasurementTypes object and returns the measurement type
     *  that has the most data points - options are based on family p, m, -, etc.
     */
    measurementType: function (types) {
        var proteomics = {};
        for (var type in types) {
            if (proteomics.hasOwnProperty(types[type].family)) {
                proteomics[types[type].family]++;
            }
            else {
                proteomics[types[type].family] = 0;
            }
        }
        for (var key in proteomics) {
            var max = 0;
            var maxType;
            if (proteomics[key] > max) {
                max = proteomics[key];
                maxType = key;
            }
        }
        return maxType;
    },
    /** this function takes in the selected button and an array of button selectors and activates
     *  or deactivates buttons.
     */
    barGraphActiveButton: function (selectedButton, buttons) {
        var barButton = buttons[1];
        $(buttons).removeClass('active');
        $(barButton).addClass('active');
        $(selectedButton).addClass('active');
    },
    /**
     * this function takes in the selector object and selector type and displays or hides the graph
     */
    displayGraph: function (selectors, selector) {
        for (var key in selectors) {
            if (key === selector) {
                d3.select(selectors[key]).style('display', 'block');
            }
            else {
                d3.select(selectors[key]).style('display', 'none');
            }
        }
    },
    /**
     * this function takes in the event, selector type, rect obj, selector object and
     * handles the button event.
     */
    buttonEventHandler: function (newSet, event, rect, selector, selectors, buttonArr) {
        event.preventDefault();
        if (newSet.length === 0) {
            $(selectors[selector]).prepend("<p class='noData'>No data selected - please " +
                "filter</p>");
            $('.tooMuchData').remove();
        }
        else {
            $('.noData').remove();
            StudyHelper.svgWidth(selectors[selector], rect);
        }
        StudyHelper.displayGraph(selectors, selector);
        StudyHelper.barGraphActiveButton(this, buttonArr);
        return false;
    },
    /**
     * this function takes in the type of measurement, selectors obj, selector type and
     * button obj and shows the measurement graph is the main type is proteomic
     */
    showProteomicGraph: function (type, selectors, selector, buttons) {
        if (type === 'p') {
            d3.select(selectors['line']).style('display', 'none');
            d3.select(selectors['bar-measurement']).style('display', 'block');
            $('label.btn').removeClass('active');
            var rects = d3.selectAll('.groupedMeasurement rect')[0];
            StudyHelper.svgWidth(selectors[selector], rects);
            var button = $('.groupByMeasurementBar')[0];
            $(buttons['bar-time']).removeClass('hidden');
            $(buttons['bar-line']).removeClass('hidden');
            $(buttons['bar-measurement']).removeClass('hidden');
            $(button).addClass('active');
            $(buttons['bar-empty']).addClass('active');
        }
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3R1ZHlHcmFwaGluZ0hlbHBlck1ldGhvZHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTdHVkeUdyYXBoaW5nSGVscGVyTWV0aG9kcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxvREFBb0Q7QUFDcEQsOENBQThDO0FBRTlDLElBQUksV0FBZSxDQUFDO0FBRXBCLFdBQVcsR0FBRztJQUVWOzs7T0FHRztJQUNILGdCQUFnQixFQUFDLFVBQVUsT0FBTztRQUM5QixNQUFNLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUE7SUFDdEQsQ0FBQztJQUVEOztPQUVHO0lBQ0gsa0JBQWtCLEVBQUMsVUFBVSxPQUFPO1FBQ2hDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQztZQUN2QyxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3hDLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDbEMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ04sTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtRQUNyQyxDQUFDO0lBQ0wsQ0FBQztJQUVEOztPQUVHO0lBQ0gsUUFBUSxFQUFFLFVBQVMsUUFBUSxFQUFFLFNBQVM7UUFDbEMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3pCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNwQixJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDWixDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFTLFFBQVk7WUFDbkMsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN0QyxHQUFHLEVBQUUsQ0FBQTtZQUNULENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUNILEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ1osQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx5REFBeUQ7Z0JBQ3pFLGtFQUFrRSxDQUFDLENBQUM7UUFDNUUsQ0FBQztJQUNMLENBQUM7SUFFRDs7T0FFRztJQUNILGVBQWUsRUFBRSxVQUFTLEtBQUs7UUFDM0IsSUFBSSxVQUFVLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDckIsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNoRCxVQUFVLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7WUFDckMsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1lBQ3RDLENBQUM7UUFDTCxDQUFDO1FBQ0QsR0FBRyxDQUFDLENBQUMsSUFBSSxHQUFHLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQztZQUN6QixJQUFJLEdBQUcsR0FBTyxDQUFDLENBQUM7WUFDaEIsSUFBSSxPQUFXLENBQUM7WUFDaEIsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hCLEdBQUcsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3RCLE9BQU8sR0FBRyxHQUFHLENBQUM7WUFDbEIsQ0FBQztRQUNMLENBQUM7UUFDRCxNQUFNLENBQUMsT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFFQTs7T0FFRztJQUNKLG9CQUFvQixFQUFFLFVBQVMsY0FBYyxFQUFFLE9BQU87UUFDbEQsSUFBSSxTQUFTLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTNCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDakMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFHRDs7T0FFRztJQUNILFlBQVksRUFBRSxVQUFTLFNBQVMsRUFBRSxRQUFRO1FBQ3RDLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDeEIsRUFBRSxDQUFDLENBQUMsR0FBRyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7Z0JBQ25CLEVBQUUsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUN4RCxDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ0osRUFBRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZELENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQztJQUVEOzs7T0FHRztJQUNILGtCQUFrQixFQUFFLFVBQVMsTUFBTSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxTQUFTO1FBQzVFLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUNuQixFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDdEIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyw4Q0FBOEM7Z0JBQzdFLFlBQVksQ0FBQyxDQUFBO1lBQ2IsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQy9CLENBQUM7UUFDRCxJQUFJLENBQUMsQ0FBQztZQUNGLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUN6QixXQUFXLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNqRCxDQUFDO1FBQ0QsV0FBVyxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDOUMsV0FBVyxDQUFDLG9CQUFvQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztRQUNsRCxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ3JCLENBQUM7SUFFRDs7O09BR0c7SUFDSCxrQkFBa0IsRUFBRSxVQUFTLElBQUksRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE9BQU87UUFDM0QsRUFBRSxDQUFDLENBQUMsSUFBSSxLQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDZCxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDdEQsRUFBRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDbEUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNyQyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDeEQsV0FBVyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDakQsSUFBSSxNQUFNLEdBQUksQ0FBQyxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDN0MsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM3QyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzdDLENBQUMsQ0FBQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNwRCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzdCLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDL0MsQ0FBQztJQUNMLENBQUM7Q0FDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlsZSBsYXN0IG1vZGlmaWVkIG9uOiBXZWQgRGVjIDIxIDIwMTYgMTQ6NTM6MzUgIFxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvZDMvZDMuZC50c1wiLz47XG5cbnZhciBTdHVkeUhlbHBlcjphbnk7XG5cblN0dWR5SGVscGVyID0ge1xuXG4gICAgLyoqIHRoaXMgZnVuY3Rpb24gdGFrZXMgaW4gZWxlbWVudCBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiBzZWxlY3RvcnNcbiAgICAgKiBbPGRpdiBpZD3igItcImxpbmVjaGFydFwiPuKAizwvZGl2PuKAiywgPGRpdiBpZD3igItcInRpbWVCYXJcIj7igIs8L2Rpdj7igIssIDxkaXYgaWQ94oCLXCJzaW5nbGVcIj7igIs8L2Rpdj7igIssXG4gICAgICogPGRpdiBpZD3igItcImJhckFzc2F5XCI+4oCLPC9kaXY+4oCLXVxuICAgICAqL1xuICAgIGdldEJ1dHRvbkVsZW1lbnQ6ZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuICQoZWxlbWVudC5zaWJsaW5ncygnOmZpcnN0JykpLmZpbmQoXCJsYWJlbFwiKVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiB0aGlzIGZ1bmN0aW9uIHRha2VzIGluIHRoZSBncmFwaERpdiBlbGVtZW50IGFuZCByZXR1cm5zIGFuIGFycmF5IG9mIDQgYnV0dG9uc1xuICAgICAqL1xuICAgIGdldFNlbGVjdG9yRWxlbWVudDpmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICBpZiAoJChlbGVtZW50KS5hdHRyKCdpZCcpICE9ICdtYWluZ3JhcGgnKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0b3IgPSBlbGVtZW50LnNpYmxpbmdzKCkuZXEoMSk7XG4gICAgICAgICAgICByZXR1cm4gJChzZWxlY3RvcikuY2hpbGRyZW4oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZWxlbWVudC5zaWJsaW5ncygpLmFkZEJhY2soKVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKiB0aGlzIGZ1bmN0aW9uIHRha2VzIGluIGFuIGVsZW1lbnQgIHNlbGVjdG9yIGFuZCBhbiBhcnJheSBvZiBzdmcgcmVjdHMgYW5kIHJldHVybnNcbiAgICAgKiByZXR1cm5zIG1lc3NhZ2Ugb3Igbm90aGluZy5cbiAgICAgKi9cbiAgICBzdmdXaWR0aDogZnVuY3Rpb24oc2VsZWN0b3IsIHJlY3RBcnJheSkge1xuICAgICAgICAkKCcudG9vTXVjaERhdGEnKS5oaWRlKCk7XG4gICAgICAgICQoJy5ub0RhdGEnKS5oaWRlKCk7XG4gICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICBfLmVhY2gocmVjdEFycmF5LCBmdW5jdGlvbihyZWN0RWxlbTphbnkpIHtcbiAgICAgICAgICAgIGlmIChyZWN0RWxlbS5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgc3VtKytcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChzdW0gPT09IDApIHtcbiAgICAgICAgICAgICQoc2VsZWN0b3IpLnByZXBlbmQoXCI8cCBjbGFzcz0nIHRvb011Y2hEYXRhJz5Ub28gbWFueSBkYXRhIHBvaW50cyB0byBkaXNwbGF5XCIgK1xuICAgICAgICAgICAgICAgIFwiPC9wPjxwICBjbGFzcz0nIHRvb011Y2hEYXRhJz5SZWNvbW1lbmQgZmlsdGVyaW5nIGJ5IHByb3RvY29sPC9wPlwiKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKiogdGhpcyBmdW5jdGlvbiB0YWtlcyBpbiB0aGUgRURERGF0YS5NZWFzdXJlbWVudFR5cGVzIG9iamVjdCBhbmQgcmV0dXJucyB0aGUgbWVhc3VyZW1lbnQgdHlwZVxuICAgICAqICB0aGF0IGhhcyB0aGUgbW9zdCBkYXRhIHBvaW50cyAtIG9wdGlvbnMgYXJlIGJhc2VkIG9uIGZhbWlseSBwLCBtLCAtLCBldGMuXG4gICAgICovXG4gICAgbWVhc3VyZW1lbnRUeXBlOiBmdW5jdGlvbih0eXBlcykge1xuICAgICAgICB2YXIgcHJvdGVvbWljcyA9IHt9O1xuICAgICAgICBmb3IgKHZhciB0eXBlIGluIHR5cGVzKSB7XG4gICAgICAgICAgICBpZiAocHJvdGVvbWljcy5oYXNPd25Qcm9wZXJ0eSh0eXBlc1t0eXBlXS5mYW1pbHkpKSB7XG4gICAgICAgICAgICAgICAgcHJvdGVvbWljc1t0eXBlc1t0eXBlXS5mYW1pbHldKys7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb3Rlb21pY3NbdHlwZXNbdHlwZV0uZmFtaWx5XSA9IDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcHJvdGVvbWljcykge1xuICAgICAgICAgICAgdmFyIG1heDphbnkgPSAwO1xuICAgICAgICAgICAgdmFyIG1heFR5cGU6YW55O1xuICAgICAgICAgICAgaWYgKHByb3Rlb21pY3Nba2V5XSA+IG1heCkge1xuICAgICAgICAgICAgICAgIG1heCA9IHByb3Rlb21pY3Nba2V5XTtcbiAgICAgICAgICAgICAgICBtYXhUeXBlID0ga2V5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXhUeXBlO1xuICAgIH0sXG5cbiAgICAgLyoqIHRoaXMgZnVuY3Rpb24gdGFrZXMgaW4gdGhlIHNlbGVjdGVkIGJ1dHRvbiBhbmQgYW4gYXJyYXkgb2YgYnV0dG9uIHNlbGVjdG9ycyBhbmQgYWN0aXZhdGVzXG4gICAgICAqICBvciBkZWFjdGl2YXRlcyBidXR0b25zLlxuICAgICAgKi9cbiAgICBiYXJHcmFwaEFjdGl2ZUJ1dHRvbjogZnVuY3Rpb24oc2VsZWN0ZWRCdXR0b24sIGJ1dHRvbnMpIHtcbiAgICAgICAgdmFyIGJhckJ1dHRvbiA9IGJ1dHRvbnNbMV07XG5cbiAgICAgICAgJChidXR0b25zKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoYmFyQnV0dG9uKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICQoc2VsZWN0ZWRCdXR0b24pLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICB9LFxuXG5cbiAgICAvKipcbiAgICAgKiB0aGlzIGZ1bmN0aW9uIHRha2VzIGluIHRoZSBzZWxlY3RvciBvYmplY3QgYW5kIHNlbGVjdG9yIHR5cGUgYW5kIGRpc3BsYXlzIG9yIGhpZGVzIHRoZSBncmFwaFxuICAgICAqL1xuICAgIGRpc3BsYXlHcmFwaDogZnVuY3Rpb24oc2VsZWN0b3JzLCBzZWxlY3Rvcikge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc2VsZWN0b3JzKSB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBzZWxlY3Rvcikge1xuICAgICAgICAgICAgICAgIGQzLnNlbGVjdChzZWxlY3RvcnNba2V5XSkuc3R5bGUoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZDMuc2VsZWN0KHNlbGVjdG9yc1trZXldKS5zdHlsZSgnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogdGhpcyBmdW5jdGlvbiB0YWtlcyBpbiB0aGUgZXZlbnQsIHNlbGVjdG9yIHR5cGUsIHJlY3Qgb2JqLCBzZWxlY3RvciBvYmplY3QgYW5kXG4gICAgICogaGFuZGxlcyB0aGUgYnV0dG9uIGV2ZW50LlxuICAgICAqL1xuICAgIGJ1dHRvbkV2ZW50SGFuZGxlcjogZnVuY3Rpb24obmV3U2V0LCBldmVudCwgcmVjdCwgc2VsZWN0b3IsIHNlbGVjdG9ycywgYnV0dG9uQXJyKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpZiAobmV3U2V0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICQoc2VsZWN0b3JzW3NlbGVjdG9yXSkucHJlcGVuZChcIjxwIGNsYXNzPSdub0RhdGEnPk5vIGRhdGEgc2VsZWN0ZWQgLSBwbGVhc2UgXCIgK1xuICAgICAgICAgICAgICAgIFwiZmlsdGVyPC9wPlwiKVxuICAgICAgICAgICAgICAgICQoJy50b29NdWNoRGF0YScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgJCgnLm5vRGF0YScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgIFN0dWR5SGVscGVyLnN2Z1dpZHRoKHNlbGVjdG9yc1tzZWxlY3Rvcl0sIHJlY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgU3R1ZHlIZWxwZXIuZGlzcGxheUdyYXBoKHNlbGVjdG9ycywgc2VsZWN0b3IpO1xuICAgICAgICAgICAgU3R1ZHlIZWxwZXIuYmFyR3JhcGhBY3RpdmVCdXR0b24odGhpcywgYnV0dG9uQXJyKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogdGhpcyBmdW5jdGlvbiB0YWtlcyBpbiB0aGUgdHlwZSBvZiBtZWFzdXJlbWVudCwgc2VsZWN0b3JzIG9iaiwgc2VsZWN0b3IgdHlwZSBhbmRcbiAgICAgKiBidXR0b24gb2JqIGFuZCBzaG93cyB0aGUgbWVhc3VyZW1lbnQgZ3JhcGggaXMgdGhlIG1haW4gdHlwZSBpcyBwcm90ZW9taWNcbiAgICAgKi9cbiAgICBzaG93UHJvdGVvbWljR3JhcGg6IGZ1bmN0aW9uKHR5cGUsIHNlbGVjdG9ycywgc2VsZWN0b3IsIGJ1dHRvbnMpIHtcbiAgICAgICAgaWYgKHR5cGUgPT09J3AnKSB7XG4gICAgICAgICAgICBkMy5zZWxlY3Qoc2VsZWN0b3JzWydsaW5lJ10pLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgIGQzLnNlbGVjdChzZWxlY3RvcnNbJ2Jhci1tZWFzdXJlbWVudCddKS5zdHlsZSgnZGlzcGxheScsICdibG9jaycpO1xuICAgICAgICAgICAgJCgnbGFiZWwuYnRuJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgdmFyIHJlY3RzID0gZDMuc2VsZWN0QWxsKCcuZ3JvdXBlZE1lYXN1cmVtZW50IHJlY3QnKVswXTtcbiAgICAgICAgICAgIFN0dWR5SGVscGVyLnN2Z1dpZHRoKHNlbGVjdG9yc1tzZWxlY3Rvcl0sIHJlY3RzKTtcbiAgICAgICAgICAgIHZhciBidXR0b24gPSAgJCgnLmdyb3VwQnlNZWFzdXJlbWVudEJhcicpWzBdO1xuICAgICAgICAgICAgJChidXR0b25zWydiYXItdGltZSddKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAkKGJ1dHRvbnNbJ2Jhci1saW5lJ10pLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICQoYnV0dG9uc1snYmFyLW1lYXN1cmVtZW50J10pLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICQoYnV0dG9uKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAkKGJ1dHRvbnNbJ2Jhci1lbXB0eSddKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgIH1cbiAgICB9XG59OyJdfQ==